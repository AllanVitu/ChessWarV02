import{I as Me,J as it,d as Vt,i as p,K as Wt,h as c,D as Ye,k as jt,A as Kt,w as zt,o as y,b as a,c as k,l as E,t as m,x as $,r as Ee,F as Oe,p as Ht,v as Qt,L as qt,m as Gt,M as Ze,N as Xt,f as Yt,O as me,P as Zt}from"./index-Bh88Vxd1.js";import{_ as ea,c as ta}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-9OWB--fr.js";import{g as aa}from"./auth-DB9CY__F.js";import"./brand-icon-CM8iIody.js";const sa="/api",et=(()=>{const s="".trim();return s?s.startsWith("ws://")||s.startsWith("wss://")?s:s.startsWith("https://")?`wss://${s.slice(8)}`:s.startsWith("http://")?`ws://${s.slice(7)}`:s:""})(),tt=async s=>{const o=await Me(`match-room-get?matchId=${encodeURIComponent(s)}`);if(!o.ok||!o.match)throw new Error("Match introuvable.");return o.match},na=async(s,o)=>{const l=await Me("match-move-add",{method:"POST",body:JSON.stringify({matchId:s,from:o.from,to:o.to,notation:o.notation})});if(!l.ok||!l.match)throw new Error("Impossible de jouer le coup.");return l.match},la=async(s,o)=>{const l=await Me("match-message-add",{method:"POST",body:JSON.stringify({matchId:s,message:o})});if(!l.ok||!l.match)throw new Error("Impossible d'envoyer le message.");return l.match},oa=async(s,o)=>{const l=await Me("match-finish",{method:"POST",body:JSON.stringify({matchId:s,result:o})});if(!l.ok||!l.match)throw new Error("Impossible de terminer le match.");return l.match},ia=(s,o,l)=>{const n=it();if(!n)return null;const r=new EventSource(`${sa}/match-stream?matchId=${encodeURIComponent(s)}&token=${encodeURIComponent(n)}`);return r.addEventListener("match",u=>{try{const b=JSON.parse(u.data);o(b)}catch{}}),l&&r.addEventListener("error",l),r},ra=(s,o,l)=>{if(!et)return null;const n=it();if(!n||!s)return null;const r=new WebSocket(et),u=JSON.stringify({type:"subscribe",matchId:s,token:n});return r.addEventListener("open",()=>{r.send(u)}),r.addEventListener("message",b=>{try{const L=JSON.parse(String(b.data));o(L)}catch{}}),l&&r.addEventListener("error",l),r},rt=["a","b","c","d","e","f","g","h"],at=()=>[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]],ca=s=>s!==""&&s===s.toUpperCase(),te=s=>ca(s)?"white":"black",fe=(s,o)=>s>=0&&s<8&&o>=0&&o<8,st=(s,o)=>`${rt[o]??""}${8-s}`,nt=s=>{const o=s[0]??"",l=Number(s[1]),n=rt.indexOf(o);return{row:8-l,col:n===-1?0:n}},U=(s,o,l)=>s[o]?.[l]??"",z=(s,o,l,n,r,u,b)=>{s.push({from:st(o,l),to:st(n,r),piece:u,capture:b})},ua=(s,o,l)=>{const n=U(s,o,l);if(!n)return[];const r=te(n),u=[],b=n.toLowerCase();if(b==="p"){const N=r==="white"?-1:1,I=r==="white"?6:1,w=o+N;if(fe(w,l)&&U(s,w,l)===""){z(u,o,l,w,l,n);const v=o+N*2;o===I&&U(s,v,l)===""&&z(u,o,l,v,l,n)}for(const v of[l-1,l+1]){if(!fe(w,v))continue;const h=U(s,w,v);h&&te(h)!==r&&z(u,o,l,w,v,n,h)}return u}if(b==="n"){const N=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[I,w]of N){const v=o+I,h=l+w;if(!fe(v,h))continue;const _=U(s,v,h);(!_||te(_)!==r)&&z(u,o,l,v,h,n,_||void 0)}return u}const L=N=>{for(const[I,w]of N){let v=o+I,h=l+w;for(;fe(v,h);){const _=U(s,v,h);if(!_)z(u,o,l,v,h,n);else{te(_)!==r&&z(u,o,l,v,h,n,_);break}v+=I,h+=w}}};if(b==="b")return L([[-1,-1],[-1,1],[1,-1],[1,1]]),u;if(b==="r")return L([[-1,0],[1,0],[0,-1],[0,1]]),u;if(b==="q")return L([[-1,-1],[-1,1],[1,-1],[1,1],[-1,0],[1,0],[0,-1],[0,1]]),u;if(b==="k"){const N=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[I,w]of N){const v=o+I,h=l+w;if(!fe(v,h))continue;const _=U(s,v,h);(!_||te(_)!==r)&&z(u,o,l,v,h,n,_||void 0)}}return u},va=(s,o)=>{const l=[];for(let n=0;n<8;n+=1)for(let r=0;r<8;r+=1){const u=U(s,n,r);u&&te(u)===o&&l.push(...ua(s,n,r))}return l},lt=(s,o)=>{const l=s.map(N=>N.slice()),n=nt(o.from),r=nt(o.to),u=o.piece,b=l[n.row],L=l[r.row];return!b||!L||(b[n.col]="",L[r.col]=u,u.toLowerCase()==="p"&&(r.row===0||r.row===7)&&(L[r.col]=u===u.toUpperCase()?"Q":"q")),l},ot=s=>`${s.from}-${s.to}`,da={class:"game-layout"},ma={class:"game-stack"},fa={class:"panel game-board"},pa={class:"panel-header"},ha={class:"panel-headline"},ba={class:"badge-soft"},ga={key:0,class:"form-message form-message--success"},ya={key:1,class:"form-message form-message--error"},wa={class:"player-strip"},ka={class:"player-avatar"},_a={class:"player-info"},Ma={class:"player-name"},Ca={class:"player-avatar"},Sa={class:"player-info"},La={class:"player-name"},Na={class:"board-wrap"},Ia={class:"board",role:"grid","aria-label":"Plateau d'echecs"},Ta=["aria-label","aria-pressed","onClick"],xa={class:"panel game-actions"},Ea=["disabled"],Oa=["disabled"],Pa={key:1,class:"game-rematch"},Aa={class:"panel game-panel"},Ja={class:"game-info"},$a={class:"metric-label"},Ra={class:"metric-value"},Ba={class:"metric-label"},Da={class:"metric-value"},Ua={class:"metric-value"},Fa={class:"panel-subsection"},Va={class:"move-list"},Wa={key:0,class:"empty-state"},ja={class:"move-ply"},Ka={class:"move-side"},za={class:"move-notation"},Ha={key:0,class:"panel-subsection match-chat"},Qa={key:0,class:"empty-state"},qa={class:"chat-row"},Ga={class:"chat-name"},Xa={class:"chat-time"},Ya={class:"chat-text"},Za={class:"chat-input-row"},es=["disabled","onKeydown"],ts=["disabled"],as={key:0,class:"form-message form-message--error"},is=Vt({__name:"GameView",setup(s){const o=Wt(),l=Yt(),n=p(()=>o.params.id?String(o.params.id):""),r=c(null),u=c([]),b=c([]),L=c("white"),N=c("white"),I=c(null),w=c(null),v=c("active"),h=c(null),_=c(null),Ce=c(null),F=c(!1),g=c(""),V=c(!1);let ae=null,H=null,Se=!1;const Q=c(""),q=c(!1),se=c(""),W=c(null),j=c(""),G=c(!1),R=c(""),pe=c(!1),T=c(0),x=c(0),O=c(0),ne=c(!1),le=c(""),he=c(!1);let be=null;const X=c(!1),oe=c("");let ie=null,Pe="";const ct=e=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e),Ae=p(()=>ct(n.value)),J=p(()=>n.value?Ae.value?"JcJ":r.value?.mode??h.value??"JcJ":"Local"),M=p(()=>J.value==="JcJ"),ut=p(()=>J.value==="JcJ"?"En ligne":J.value),ge=p(()=>{const e=r.value?.opponent??_.value;return e||"Adversaire"}),ye=p(()=>r.value?.timeControl??Ce.value??"10+0"),vt=p(()=>J.value==="Local"?"Camp joueur 1":"Votre couleur"),dt=p(()=>J.value==="Local"?"Joueur 2":"Adversaire"),Je=p(()=>M.value?F.value?"Connexion au match en ligne...":V.value?"Envoi du coup...":v.value!=="active"?"Match termine. Vous pouvez proposer une revanche.":C.value===Y.value?"A vous de jouer.":"En attente du coup adverse.":""),mt=async()=>{if(oe.value)return;const e=await aa();oe.value=e?.id??""};Ye(n,async()=>{const e=n.value||"local";if(Pe!==e&&(Pe=e,me({payload:{mode:J.value}})),we(),ue(),ke(),ee(),u.value=[],b.value=[],g.value="",V.value=!1,L.value="white",N.value="white",I.value=null,w.value=null,v.value="active",h.value=null,_.value=null,Ce.value=null,Q.value="",q.value=!1,se.value="",j.value="",G.value=!1,R.value="",pe.value=!1,T.value=0,x.value=0,O.value=0,ne.value=!1,le.value="",he.value=!1,X.value=!1,!n.value){r.value=null,He();return}const t=Ae.value;t&&(h.value="JcJ"),r.value=await Zt(n.value),r.value?.mode==="JcJ"?await qe():r.value?He():t&&await qe()},{immediate:!0});const $e=p(()=>r.value?.side??"Aleatoire"),Y=p(()=>M.value?L.value:$e.value==="Blancs"?"white":$e.value==="Noirs"?"black":Number.parseInt(n.value.slice(-1)||"0",10)%2===0?"white":"black"),B=p(()=>M.value?v.value!=="active":X.value),Re=p(()=>M.value?Y.value==="white"?w.value??"":I.value??"":""),ft=e=>{const t=e.trim(),i=/^(\d+)(?:\+(\d+))?$/.exec(t);if(!i)return{initialMs:600*1e3,incrementMs:0};const f=Math.max(1,Number.parseInt(i[1]??"10",10)),d=Math.max(0,Number.parseInt(i[2]??"0",10));return{initialMs:f*60*1e3,incrementMs:d*1e3}},Le=p(()=>ft(ye.value)),Be=e=>{const t=Math.max(0,Math.ceil(e/1e3)),i=Math.floor(t/60),f=t%60;return`${i}:${f.toString().padStart(2,"0")}`},De=e=>e<=1e4?"player-clock--danger":e<=3e4?"player-clock--warning":"",pt=p(()=>Be(T.value)),ht=p(()=>Be(x.value)),Ue=p(()=>M.value?v.value==="active"&&!F.value&&!V.value:!X.value),re=c(at()),C=c("white"),P=c(null),ce=c(null),Z=c([]),Fe=["a","b","c","d","e","f","g","h"],bt=[8,7,6,5,4,3,2,1],gt=e=>{const t=e[0]??"",i=Number(e[1]),f=Fe.indexOf(t);return{row:8-i,col:f===-1?0:f}},yt={p:"♟",r:"♜",n:"♞",b:"♝",q:"♛",k:"♚",P:"♙",R:"♖",N:"♘",B:"♗",Q:"♕",K:"♔"},wt={p:"pion noir",r:"tour noire",n:"cavalier noir",b:"fou noir",q:"dame noire",k:"roi noir",P:"pion blanc",R:"tour blanche",N:"cavalier blanc",B:"fou blanc",Q:"dame blanche",K:"roi blanc"},kt=p(()=>va(re.value,C.value)),Ve=p(()=>P.value?kt.value.filter(e=>e.from===P.value):[]),_t=p(()=>new Set(Ve.value.map(e=>e.to))),Mt=p(()=>M.value?v.value==="active"&&!F.value&&!V.value&&C.value===Y.value:!X.value),We=p(()=>J.value==="Local"?"Joueur 1":Y.value==="white"?"Vous":ge.value),je=p(()=>J.value==="Local"?"Joueur 2":Y.value==="black"?"Vous":ge.value),Ke=e=>{const t=e.trim();return t&&t.split(" ").filter(Boolean).slice(0,2).map(i=>i[0]?.toUpperCase()??"").join("")||"?"},Ct=e=>{let t=at();const i=[];let f=null;for(const d of e){const S=gt(d.from),ve=t[S.row]?.[S.col]??"";ve&&(t=lt(t,{from:d.from,to:d.to,piece:ve}),i.push({ply:d.ply,side:d.side==="white"?"white":"black",notation:d.notation}),f={from:d.from,to:d.to})}re.value=t,Z.value=i,ce.value=f,P.value=null},K=e=>{u.value=e.moves??[],b.value=e.messages??[];let t=e.yourSide;oe.value&&(e.whiteId&&e.whiteId===oe.value?t="white":e.blackId&&e.blackId===oe.value&&(t="black")),L.value=t??"white",N.value=e.sideToMove,I.value=e.whiteId??null,w.value=e.blackId??null,v.value=e.status??"active",h.value=e.mode??"JcJ",e.opponent&&(_.value=e.opponent),e.timeControl&&(Ce.value=e.timeControl),C.value=e.sideToMove,V.value=!1,Ct(u.value),Nt(e)},ee=()=>{be&&(clearInterval(be),be=null)},Ne=()=>{ne.value||(T.value===0||x.value===0)&&(ne.value=!0,At())},ze=()=>{ee(),O.value=Date.now(),be=setInterval(()=>{if(!Ue.value||B.value){O.value=Date.now();return}const e=Date.now(),t=e-O.value;O.value=e,C.value==="white"?T.value=Math.max(0,T.value-t):x.value=Math.max(0,x.value-t),Ne()},250)},St=()=>{if(!Ue.value||B.value)return;const e=Date.now(),t=e-O.value;O.value=e,C.value==="white"?T.value=Math.max(0,T.value-t):x.value=Math.max(0,x.value-t)},Lt=e=>{const{incrementMs:t}=Le.value;t<=0||(e==="white"?T.value+=t:x.value+=t)},He=()=>{const{initialMs:e}=Le.value;T.value=e,x.value=e,X.value=!1,ne.value=!1,le.value="",he.value=!1,O.value=Date.now(),ze()},Nt=e=>{const{initialMs:t,incrementMs:i}=Le.value;let f=t,d=t;const S=A=>{if(!A)return null;const D=new Date(A).getTime();return Number.isFinite(D)?D:null};let de=S(e.createdAt)??Date.now();for(const A of e.moves??[]){const D=S(A.createdAt);if(!D)continue;const _e=Math.max(0,D-de);A.side==="white"?f=Math.max(0,f-_e+i):d=Math.max(0,d-_e+i),de=D}if(e.status==="active"){const A=Math.max(0,Date.now()-de);e.sideToMove==="white"?f=Math.max(0,f-A):d=Math.max(0,d-A)}(!Number.isFinite(f)||!Number.isFinite(d))&&(f=t,d=t),e.status==="active"&&(!e.moves||e.moves.length===0)&&(f<=0||d<=0)&&(f=t,d=t),T.value=f,x.value=d,O.value=Date.now(),ne.value=e.status!=="active",Ne(),e.status==="active"?ze():ee()},we=()=>{if(!H)return;const e=H;H=null,e.close()},ue=()=>{ae&&(ae.close(),ae=null)},ke=()=>{ie&&(clearInterval(ie),ie=null)},Qe=async(e=!1)=>{if(!(!n.value||Se)){Se=!0;try{const t=await tt(n.value);K(t),g.value&&(g.value="")}catch(t){e||(g.value=t.message)}finally{Se=!1}}},It=async e=>{if(!(!e||e.matchId!==n.value)){if(e.type==="state"&&e.match){K(e.match),g.value&&(g.value="");return}if(e.type==="match-update"){await Qe();return}e.type==="error"&&(g.value=e.message||"Erreur temps reel.")}},Ie=()=>{ie||(ie=setInterval(async()=>{await Qe(!0)},3e3))},Te=()=>{n.value&&(ue(),ae=ia(n.value,e=>{K(e),g.value&&(g.value="")},()=>{g.value||(g.value="Connexion temps reel interrompue."),Ie()}),ae||Ie())},Tt=()=>{if(!n.value)return;ke(),ue(),we();const e=ra(n.value,t=>{It(t)},()=>{g.value||(g.value="Connexion temps reel interrompue."),Te()});if(!e){Te();return}H=e,e.addEventListener("close",()=>{H===e&&(H=null,g.value||(g.value="Connexion temps reel interrompue."),Te())})},qe=async()=>{if(n.value){F.value=!0,g.value="",ke(),ue(),we(),await mt();try{const e=await tt(n.value);K(e),Tt()}catch(e){g.value=e.message,Ie()}finally{F.value=!1}}},Ge=(e,t)=>e?t==="white"?e===e.toUpperCase():e===e.toLowerCase():!1,xt=e=>{M.value||(St(),Lt(C.value),Ne()),re.value=lt(re.value,e),Z.value=[...Z.value,{ply:Z.value.length+1,side:C.value,notation:ot(e)}],ce.value={from:e.from,to:e.to},P.value=null,C.value=C.value==="white"?"black":"white",O.value=Date.now()},Et=async e=>{if(n.value&&v.value==="active"){V.value=!0,g.value="",ee();try{const t=await na(n.value,{from:e.from,to:e.to,notation:ot(e)});K(t)}catch(t){g.value=t.message}finally{V.value=!1}}},Ot=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},Xe=async()=>{if(!n.value||!M.value)return;const e=Q.value.trim();if(e){q.value=!0,se.value="";try{const t=await la(n.value,e);K(t),Q.value="",await Ze(),W.value&&(W.value.scrollTop=W.value.scrollHeight)}catch(t){se.value=t.message}finally{q.value=!1}}},Pt=async()=>{if(!Re.value){j.value="Adversaire introuvable.",G.value=!0;return}j.value="",G.value=!1;try{const e=await ta(Re.value,ye.value,"Aleatoire");j.value=e.message,G.value=!e.ok,e.ok&&e.status==="accepted"&&e.matchId&&(Xt(),await l.push(`/jeu/${e.matchId}`))}catch(e){j.value=e.message,G.value=!0}},xe=async e=>{if(!(!n.value||!M.value)){R.value="",pe.value=!1;try{const t=await oa(n.value,e);K(t),e==="draw"?R.value="Match nul enregistre.":e==="timeout"?R.value="Temps ecoule.":R.value="Match termine.",me({name:"finish_game",payload:{matchId:n.value,result:e}})}catch(t){R.value=t.message,pe.value=!0}}},At=async()=>{if(!B.value){if(ee(),M.value){await xe("timeout");return}X.value=!0,le.value="Temps ecoule. Match termine.",he.value=!0,me({payload:{matchId:n.value||"local"}})}},Jt=(e,t)=>{if(!Mt.value)return;if(!P.value){if(!t||!Ge(t,C.value))return;P.value=e;return}if(e===P.value){P.value=null;return}const i=Ve.value.find(f=>f.to===e);if(!i){t&&Ge(t,C.value)&&(P.value=e);return}if(M.value){Et(i);return}xt(i)},$t=async()=>{if(M.value){if(B.value)return;await xe("resign");return}me({payload:{matchId:n.value||"local"}}),await l.push("/dashboard")},Rt=async()=>{if(M.value){if(B.value)return;await xe("draw");return}me({payload:{matchId:n.value||"local"}}),await l.push("/dashboard")},Bt=async()=>{await l.push("/dashboard")};Ye(()=>b.value.length,async()=>{await Ze(),W.value&&(W.value.scrollTop=W.value.scrollHeight)}),jt(()=>{we(),ue(),ke(),ee()});const Dt=p(()=>bt.flatMap((e,t)=>Fe.map((i,f)=>{const d=re.value[t]?.[f]??"",S=`${i}${e}`,ve=(t+f)%2===1,de=d?d===d.toUpperCase()?"light":"dark":"",A=P.value===S,D=_t.value.has(S),_e=ce.value?.from===S||ce.value?.to===S,Ut=ce.value?.to===S,Ft=d?`${S} ${wt[d]??"piece"}`:`${S} vide`;return{id:S,piece:d,symbol:yt[d]??"",dark:ve,tone:de,isSelected:A,isTarget:D,isLast:_e,isArrival:Ut,ariaLabel:Ft}})));return(e,t)=>(y(),Kt(ea,{eyebrow:"Partie",title:`Match ${n.value||"Libre"}`,subtitle:`Mode ${ut.value} - ${ge.value} - Cadence ${ye.value}`},{default:zt(()=>[a("section",da,[a("div",ma,[a("div",fa,[a("div",pa,[a("div",null,[t[1]||(t[1]=a("p",{class:"panel-title"},"Plateau",-1)),a("h3",ha,"Tour: "+m(C.value==="white"?"Blancs":"Noirs"),1)]),a("span",ba,m(J.value==="JcJ"?"En ligne":"Local"),1)]),Je.value?(y(),k("p",ga,m(Je.value),1)):E("",!0),g.value?(y(),k("p",ya,m(g.value),1)):E("",!0),le.value?(y(),k("p",{key:2,class:$(["form-message",he.value?"form-message--error":"form-message--success"])},m(le.value),3)):E("",!0),a("div",wa,[a("div",{class:$(["player-chip",C.value==="white"&&"player-chip--active"])},[a("div",ka,m(Ke(We.value)),1),a("div",_a,[a("p",Ma,m(We.value),1),t[2]||(t[2]=a("p",{class:"player-meta"},"Blancs",-1))]),a("div",{class:$(["player-clock",De(T.value)])},m(pt.value),3)],2),t[4]||(t[4]=a("span",{class:"vs-pill"},"VS",-1)),a("div",{class:$(["player-chip",C.value==="black"&&"player-chip--active"])},[a("div",Ca,m(Ke(je.value)),1),a("div",Sa,[a("p",La,m(je.value),1),t[3]||(t[3]=a("p",{class:"player-meta"},"Noirs",-1))]),a("div",{class:$(["player-clock",De(x.value)])},m(ht.value),3)],2)]),a("div",Na,[a("div",Ia,[(y(!0),k(Oe,null,Ee(Dt.value,i=>(y(),k("button",{key:i.id,type:"button",class:$(["square",i.dark?"square--dark":"square--light",i.isLast?"square--last":"",i.isArrival?"square--arrival":"",i.isSelected?"square--selected":"",i.isTarget?"square--target":""]),"aria-label":i.ariaLabel,"aria-pressed":i.isSelected,role:"gridcell",onClick:f=>Jt(i.id,i.piece)},[i.piece?(y(),k("span",{key:0,class:$(["piece",i.tone==="light"?"piece--light":"piece--dark",i.isArrival?"piece--impact":""])},m(i.symbol),3)):E("",!0)],10,Ta))),128))])])]),a("div",xa,[t[7]||(t[7]=a("div",null,[a("p",{class:"panel-title"},"Actions"),a("h3",{class:"panel-headline"},"Fin de match"),a("p",{class:"panel-sub"},"Gerez la partie en cours en un clic.")],-1)),a("button",{class:"button-ghost game-action",type:"button",disabled:B.value,onClick:$t}," Abandonner ",8,Ea),a("button",{class:"button-ghost game-action",type:"button",disabled:B.value,onClick:Rt}," Match Nul ",8,Oa),R.value?(y(),k("p",{key:0,class:$(["form-message",pe.value?"form-message--error":"form-message--success"])},m(R.value),3)):E("",!0),M.value&&B.value?(y(),k("div",Pa,[t[5]||(t[5]=a("p",{class:"panel-title"},"Revanche",-1)),t[6]||(t[6]=a("p",{class:"panel-sub"},"Proposez une nouvelle partie a votre adversaire.",-1)),a("div",{class:"game-rematch-actions"},[a("button",{class:"button-primary",type:"button",onClick:Pt}," Proposer une revanche "),a("button",{class:"button-ghost",type:"button",onClick:Bt}," Retour au tableau ")]),j.value?(y(),k("p",{key:0,class:$(["form-message",G.value?"form-message--error":"form-message--success"])},m(j.value),3)):E("",!0)])):E("",!0)])]),a("div",Aa,[t[11]||(t[11]=a("div",{class:"panel-header"},[a("div",null,[a("p",{class:"panel-title"},"Commandes"),a("h3",{class:"panel-headline"},"Gestion du match")])],-1)),a("div",Ja,[a("div",null,[a("p",$a,m(vt.value),1),a("p",Ra,m(Y.value==="white"?"Blancs":"Noirs"),1)]),a("div",null,[a("p",Ba,m(dt.value),1),a("p",Da,m(ge.value),1)]),a("div",null,[t[8]||(t[8]=a("p",{class:"metric-label"},"Cadence",-1)),a("p",Ua,m(ye.value),1)])]),a("div",Fa,[t[9]||(t[9]=a("p",{class:"panel-title"},"Historique",-1)),a("div",Va,[Z.value.length?E("",!0):(y(),k("div",Wa,"Aucun coup joue.")),(y(!0),k(Oe,null,Ee(Z.value,i=>(y(),k("div",{key:i.ply,class:"move-item"},[a("span",ja,"#"+m(i.ply),1),a("span",Ka,m(i.side==="white"?"Blancs":"Noirs"),1),a("span",za,m(i.notation),1)]))),128))])]),M.value?(y(),k("div",Ha,[t[10]||(t[10]=a("p",{class:"panel-title"},"Chat",-1)),a("div",{ref_key:"chatListRef",ref:W,class:"chat-list"},[b.value.length?E("",!0):(y(),k("div",Qa,"Aucun message.")),(y(!0),k(Oe,null,Ee(b.value,i=>(y(),k("div",{key:i.id,class:"chat-item"},[a("div",qa,[a("span",Ga,m(i.userName),1),a("span",Xa,m(Ot(i.createdAt)),1)]),a("p",Ya,m(i.message),1)]))),128))],512),a("div",Za,[Ht(a("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>Q.value=i),type:"text",placeholder:"Ecrire un message...","aria-label":"Message",disabled:q.value||F.value,onKeydown:qt(Gt(Xe,["prevent"]),["enter"])},null,40,es),[[Qt,Q.value]]),a("button",{class:"button-primary",type:"button",disabled:q.value||F.value||!Q.value.trim(),onClick:Xe},m(q.value?"Envoi...":"Envoyer"),9,ts)]),se.value?(y(),k("p",as,m(se.value),1)):E("",!0)])):E("",!0)])])]),_:1},8,["title","subtitle"]))}});export{is as default};
