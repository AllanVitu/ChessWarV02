import{N as Me,O as Ye,P as Ze,Q as jt,J as ct,d as Kt,i as h,m as qt,h as c,I as et,k as Qt,E as zt,w as Ht,o as b,b as a,c as k,l as x,t as m,y as $,r as xe,F as Oe,q as Gt,v as Xt,S as Yt,p as Zt,U as tt,V as ea,f as ta,W as me,X as aa,Y as sa}from"./index-vPvGcPAP.js";import{_ as na,c as la}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CrY_gPxS.js";import"./brand-icon-BJNb36kE.js";const oa="/api",at=(()=>{const s="".trim();return s?s.startsWith("ws://")||s.startsWith("wss://")?s:s.startsWith("https://")?`wss://${s.slice(8)}`:s.startsWith("http://")?`ws://${s.slice(7)}`:s:""})(),st=async s=>{const o=await Me(`match-room-get?matchId=${encodeURIComponent(s)}`);if(!o.ok||!o.match)throw new Error("Match introuvable.");return o.match},ia=async(s,o)=>{if(Ye())throw await Ze("match-move",{matchId:s,...o}),new Error("Connexion hors ligne. Coup mis en attente.");try{const n=await Me("match-move-add",{method:"POST",body:JSON.stringify({matchId:s,from:o.from,to:o.to,notation:o.notation})});if(!n.ok||!n.match)throw new Error("Impossible de jouer le coup.");return n.match}catch(n){throw jt(n)||Ye()?(await Ze("match-move",{matchId:s,...o}),new Error("Connexion instable. Coup mis en attente.")):n}},ra=async(s,o)=>{const n=await Me("match-message-add",{method:"POST",body:JSON.stringify({matchId:s,message:o})});if(!n.ok||!n.match)throw new Error("Impossible d'envoyer le message.");return n.match},ca=async(s,o)=>{const n=await Me("match-finish",{method:"POST",body:JSON.stringify({matchId:s,result:o})});if(!n.ok||!n.match)throw new Error("Impossible de terminer le match.");return n.match},ua=(s,o,n)=>{const l=ct();if(!l)return null;const r=new EventSource(`${oa}/match-stream?matchId=${encodeURIComponent(s)}&token=${encodeURIComponent(l)}`);return r.addEventListener("match",u=>{try{const w=JSON.parse(u.data);o(w)}catch{}}),n&&r.addEventListener("error",n),r},va=(s,o,n)=>{if(!at)return null;const l=ct();if(!l||!s)return null;const r=new WebSocket(at),u=JSON.stringify({type:"subscribe",matchId:s,token:l});return r.addEventListener("open",()=>{r.send(u)}),r.addEventListener("message",w=>{try{const N=JSON.parse(String(w.data));o(N)}catch{}}),n&&r.addEventListener("error",n),r},ut=["a","b","c","d","e","f","g","h"],nt=()=>[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]],da=s=>s!==""&&s===s.toUpperCase(),te=s=>da(s)?"white":"black",fe=(s,o)=>s>=0&&s<8&&o>=0&&o<8,lt=(s,o)=>`${ut[o]??""}${8-s}`,ot=s=>{const o=s[0]??"",n=Number(s[1]),l=ut.indexOf(o);return{row:8-n,col:l===-1?0:l}},D=(s,o,n)=>s[o]?.[n]??"",q=(s,o,n,l,r,u,w)=>{s.push({from:lt(o,n),to:lt(l,r),piece:u,capture:w})},ma=(s,o,n)=>{const l=D(s,o,n);if(!l)return[];const r=te(l),u=[],w=l.toLowerCase();if(w==="p"){const L=r==="white"?-1:1,I=r==="white"?6:1,g=o+L;if(fe(g,n)&&D(s,g,n)===""){q(u,o,n,g,n,l);const v=o+L*2;o===I&&D(s,v,n)===""&&q(u,o,n,v,n,l)}for(const v of[n-1,n+1]){if(!fe(g,v))continue;const p=D(s,g,v);p&&te(p)!==r&&q(u,o,n,g,v,l,p)}return u}if(w==="n"){const L=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[I,g]of L){const v=o+I,p=n+g;if(!fe(v,p))continue;const _=D(s,v,p);(!_||te(_)!==r)&&q(u,o,n,v,p,l,_||void 0)}return u}const N=L=>{for(const[I,g]of L){let v=o+I,p=n+g;for(;fe(v,p);){const _=D(s,v,p);if(!_)q(u,o,n,v,p,l);else{te(_)!==r&&q(u,o,n,v,p,l,_);break}v+=I,p+=g}}};if(w==="b")return N([[-1,-1],[-1,1],[1,-1],[1,1]]),u;if(w==="r")return N([[-1,0],[1,0],[0,-1],[0,1]]),u;if(w==="q")return N([[-1,-1],[-1,1],[1,-1],[1,1],[-1,0],[1,0],[0,-1],[0,1]]),u;if(w==="k"){const L=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[I,g]of L){const v=o+I,p=n+g;if(!fe(v,p))continue;const _=D(s,v,p);(!_||te(_)!==r)&&q(u,o,n,v,p,l,_||void 0)}}return u},fa=(s,o)=>{const n=[];for(let l=0;l<8;l+=1)for(let r=0;r<8;r+=1){const u=D(s,l,r);u&&te(u)===o&&n.push(...ma(s,l,r))}return n},it=(s,o)=>{const n=s.map(L=>L.slice()),l=ot(o.from),r=ot(o.to),u=o.piece,w=n[l.row],N=n[r.row];return!w||!N||(w[l.col]="",N[r.col]=u,u.toLowerCase()==="p"&&(r.row===0||r.row===7)&&(N[r.col]=u===u.toUpperCase()?"Q":"q")),n},rt=s=>`${s.from}-${s.to}`,ha={class:"game-layout"},pa={class:"game-stack"},wa={class:"panel game-board"},ya={class:"panel-header"},ba={class:"panel-headline"},ga={class:"badge-soft"},ka={key:0,class:"form-message form-message--success"},_a={key:1,class:"form-message form-message--error"},Ma={class:"player-strip"},Ca={class:"player-avatar"},Sa={class:"player-info"},Na={class:"player-name"},La={class:"player-avatar"},Ia={class:"player-info"},Ta={class:"player-name"},Ea={class:"board-wrap"},xa={class:"board",role:"grid","aria-label":"Plateau d'echecs"},Oa=["aria-label","aria-pressed","onClick"],Pa={class:"panel game-actions"},Aa=["disabled"],Ja=["disabled"],$a={key:1,class:"game-rematch"},Ra={class:"panel game-panel"},Ba={class:"game-info"},Ua={class:"metric-label"},Da={class:"metric-value"},Fa={class:"metric-label"},Va={class:"metric-value"},Wa={class:"metric-value"},ja={class:"panel-subsection"},Ka={class:"move-list"},qa={key:0,class:"empty-state"},Qa={class:"move-ply"},za={class:"move-side"},Ha={class:"move-notation"},Ga={key:0,class:"panel-subsection match-chat"},Xa={key:0,class:"empty-state"},Ya={class:"chat-row"},Za={class:"chat-name"},es={class:"chat-time"},ts={class:"chat-text"},as={class:"chat-input-row"},ss=["disabled","onKeydown"],ns=["disabled"],ls={key:0,class:"form-message form-message--error"},cs=Kt({__name:"GameView",setup(s){const o=qt(),n=ta(),l=h(()=>o.params.id?String(o.params.id):""),r=c(null),u=c([]),w=c([]),N=c("white"),L=c("white"),I=c(null),g=c(null),v=c("active"),p=c(null),_=c(null),Ce=c(null),F=c(!1),y=c(""),V=c(!1);let ae=null,Q=null,Se=!1;const z=c(""),H=c(!1),se=c(""),W=c(null),j=c(""),G=c(!1),R=c(""),he=c(!1),T=c(0),E=c(0),O=c(0),ne=c(!1),le=c(""),pe=c(!1);let we=null;const X=c(!1),oe=c("");let ie=null,Pe="";const vt=e=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e),Ae=h(()=>vt(l.value)),J=h(()=>l.value?Ae.value?"JcJ":r.value?.mode??p.value??"JcJ":"Local"),M=h(()=>J.value==="JcJ"),dt=h(()=>J.value==="JcJ"?"En ligne":J.value),ye=h(()=>{const e=r.value?.opponent??_.value;return e||"Adversaire"}),be=h(()=>r.value?.timeControl??Ce.value??"10+0"),mt=h(()=>J.value==="Local"?"Camp joueur 1":"Votre couleur"),ft=h(()=>J.value==="Local"?"Joueur 2":"Adversaire"),Je=h(()=>M.value?F.value?"Connexion au match en ligne...":V.value?"Envoi du coup...":v.value!=="active"?"Match termine. Vous pouvez proposer une revanche.":C.value===Y.value?"A vous de jouer.":"En attente du coup adverse.":""),ht=async()=>{if(oe.value)return;const e=await sa();oe.value=e?.id??""};et(l,async()=>{const e=l.value||"local";if(Pe!==e&&(Pe=e,me({payload:{mode:J.value}})),ge(),ue(),ke(),ee(),u.value=[],w.value=[],y.value="",V.value=!1,N.value="white",L.value="white",I.value=null,g.value=null,v.value="active",p.value=null,_.value=null,Ce.value=null,z.value="",H.value=!1,se.value="",j.value="",G.value=!1,R.value="",he.value=!1,T.value=0,E.value=0,O.value=0,ne.value=!1,le.value="",pe.value=!1,X.value=!1,!l.value){r.value=null,Qe();return}const t=Ae.value;t&&(p.value="JcJ"),r.value=await aa(l.value),r.value?.mode==="JcJ"?await He():r.value?Qe():t&&await He()},{immediate:!0});const $e=h(()=>r.value?.side??"Aleatoire"),Y=h(()=>M.value?N.value:$e.value==="Blancs"?"white":$e.value==="Noirs"?"black":Number.parseInt(l.value.slice(-1)||"0",10)%2===0?"white":"black"),B=h(()=>M.value?v.value!=="active":X.value),Re=h(()=>M.value?Y.value==="white"?g.value??"":I.value??"":""),pt=e=>{const t=e.trim(),i=/^(\d+)(?:\+(\d+))?$/.exec(t);if(!i)return{initialMs:600*1e3,incrementMs:0};const f=Math.max(1,Number.parseInt(i[1]??"10",10)),d=Math.max(0,Number.parseInt(i[2]??"0",10));return{initialMs:f*60*1e3,incrementMs:d*1e3}},Ne=h(()=>pt(be.value)),Be=e=>{const t=Math.max(0,Math.ceil(e/1e3)),i=Math.floor(t/60),f=t%60;return`${i}:${f.toString().padStart(2,"0")}`},Ue=e=>e<=1e4?"player-clock--danger":e<=3e4?"player-clock--warning":"",wt=h(()=>Be(T.value)),yt=h(()=>Be(E.value)),De=h(()=>M.value?v.value==="active"&&!F.value&&!V.value:!X.value),re=c(nt()),C=c("white"),P=c(null),ce=c(null),Z=c([]),Fe=["a","b","c","d","e","f","g","h"],bt=[8,7,6,5,4,3,2,1],gt=e=>{const t=e[0]??"",i=Number(e[1]),f=Fe.indexOf(t);return{row:8-i,col:f===-1?0:f}},kt={p:"♟",r:"♜",n:"♞",b:"♝",q:"♛",k:"♚",P:"♙",R:"♖",N:"♘",B:"♗",Q:"♕",K:"♔"},_t={p:"pion noir",r:"tour noire",n:"cavalier noir",b:"fou noir",q:"dame noire",k:"roi noir",P:"pion blanc",R:"tour blanche",N:"cavalier blanc",B:"fou blanc",Q:"dame blanche",K:"roi blanc"},Mt=h(()=>fa(re.value,C.value)),Ve=h(()=>P.value?Mt.value.filter(e=>e.from===P.value):[]),Ct=h(()=>new Set(Ve.value.map(e=>e.to))),St=h(()=>M.value?v.value==="active"&&!F.value&&!V.value&&C.value===Y.value:!X.value),We=h(()=>J.value==="Local"?"Joueur 1":Y.value==="white"?"Vous":ye.value),je=h(()=>J.value==="Local"?"Joueur 2":Y.value==="black"?"Vous":ye.value),Ke=e=>{const t=e.trim();return t&&t.split(" ").filter(Boolean).slice(0,2).map(i=>i[0]?.toUpperCase()??"").join("")||"?"},Nt=e=>{let t=nt();const i=[];let f=null;for(const d of e){const S=gt(d.from),ve=t[S.row]?.[S.col]??"";ve&&(t=it(t,{from:d.from,to:d.to,piece:ve}),i.push({ply:d.ply,side:d.side==="white"?"white":"black",notation:d.notation}),f={from:d.from,to:d.to})}re.value=t,Z.value=i,ce.value=f,P.value=null},K=e=>{u.value=e.moves??[],w.value=e.messages??[];let t=e.yourSide;oe.value&&(e.whiteId&&e.whiteId===oe.value?t="white":e.blackId&&e.blackId===oe.value&&(t="black")),N.value=t??"white",L.value=e.sideToMove,I.value=e.whiteId??null,g.value=e.blackId??null,v.value=e.status??"active",p.value=e.mode??"JcJ",e.opponent&&(_.value=e.opponent),e.timeControl&&(Ce.value=e.timeControl),C.value=e.sideToMove,V.value=!1,Nt(u.value),Tt(e)},ee=()=>{we&&(clearInterval(we),we=null)},Le=()=>{ne.value||(T.value===0||E.value===0)&&(ne.value=!0,$t())},qe=()=>{ee(),O.value=Date.now(),we=setInterval(()=>{if(!De.value||B.value){O.value=Date.now();return}const e=Date.now(),t=e-O.value;O.value=e,C.value==="white"?T.value=Math.max(0,T.value-t):E.value=Math.max(0,E.value-t),Le()},250)},Lt=()=>{if(!De.value||B.value)return;const e=Date.now(),t=e-O.value;O.value=e,C.value==="white"?T.value=Math.max(0,T.value-t):E.value=Math.max(0,E.value-t)},It=e=>{const{incrementMs:t}=Ne.value;t<=0||(e==="white"?T.value+=t:E.value+=t)},Qe=()=>{const{initialMs:e}=Ne.value;T.value=e,E.value=e,X.value=!1,ne.value=!1,le.value="",pe.value=!1,O.value=Date.now(),qe()},Tt=e=>{const{initialMs:t,incrementMs:i}=Ne.value;let f=t,d=t;const S=A=>{if(!A)return null;const U=new Date(A).getTime();return Number.isFinite(U)?U:null};let de=S(e.createdAt)??Date.now();for(const A of e.moves??[]){const U=S(A.createdAt);if(!U)continue;const _e=Math.max(0,U-de);A.side==="white"?f=Math.max(0,f-_e+i):d=Math.max(0,d-_e+i),de=U}if(e.status==="active"){const A=Math.max(0,Date.now()-de);e.sideToMove==="white"?f=Math.max(0,f-A):d=Math.max(0,d-A)}(!Number.isFinite(f)||!Number.isFinite(d))&&(f=t,d=t),e.status==="active"&&(!e.moves||e.moves.length===0)&&(f<=0||d<=0)&&(f=t,d=t),T.value=f,E.value=d,O.value=Date.now(),ne.value=e.status!=="active",Le(),e.status==="active"?qe():ee()},ge=()=>{if(!Q)return;const e=Q;Q=null,e.close()},ue=()=>{ae&&(ae.close(),ae=null)},ke=()=>{ie&&(clearInterval(ie),ie=null)},ze=async(e=!1)=>{if(!(!l.value||Se)){Se=!0;try{const t=await st(l.value);K(t),y.value&&(y.value="")}catch(t){e||(y.value=t.message)}finally{Se=!1}}},Et=async e=>{if(!(!e||e.matchId!==l.value)){if(e.type==="state"&&e.match){K(e.match),y.value&&(y.value="");return}if(e.type==="match-update"){await ze();return}e.type==="error"&&(y.value=e.message||"Erreur temps reel.")}},Ie=()=>{ie||(ie=setInterval(async()=>{await ze(!0)},3e3))},Te=()=>{l.value&&(ue(),ae=ua(l.value,e=>{K(e),y.value&&(y.value="")},()=>{y.value||(y.value="Connexion temps reel interrompue."),Ie()}),ae||Ie())},xt=()=>{if(!l.value)return;ke(),ue(),ge();const e=va(l.value,t=>{Et(t)},()=>{y.value||(y.value="Connexion temps reel interrompue."),Te()});if(!e){Te();return}Q=e,e.addEventListener("close",()=>{Q===e&&(Q=null,y.value||(y.value="Connexion temps reel interrompue."),Te())})},He=async()=>{if(l.value){F.value=!0,y.value="",ke(),ue(),ge(),await ht();try{const e=await st(l.value);K(e),xt()}catch(e){y.value=e.message,Ie()}finally{F.value=!1}}},Ge=(e,t)=>e?t==="white"?e===e.toUpperCase():e===e.toLowerCase():!1,Ot=e=>{M.value||(Lt(),It(C.value),Le()),re.value=it(re.value,e),Z.value=[...Z.value,{ply:Z.value.length+1,side:C.value,notation:rt(e)}],ce.value={from:e.from,to:e.to},P.value=null,C.value=C.value==="white"?"black":"white",O.value=Date.now()},Pt=async e=>{if(l.value&&v.value==="active"){V.value=!0,y.value="",ee();try{const t=await ia(l.value,{from:e.from,to:e.to,notation:rt(e)});K(t)}catch(t){y.value=t.message}finally{V.value=!1}}},At=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},Xe=async()=>{if(!l.value||!M.value)return;const e=z.value.trim();if(e){H.value=!0,se.value="";try{const t=await ra(l.value,e);K(t),z.value="",await tt(),W.value&&(W.value.scrollTop=W.value.scrollHeight)}catch(t){se.value=t.message}finally{H.value=!1}}},Jt=async()=>{if(!Re.value){j.value="Adversaire introuvable.",G.value=!0;return}j.value="",G.value=!1;try{const e=await la(Re.value,be.value,"Aleatoire");j.value=e.message,G.value=!e.ok,e.ok&&e.status==="accepted"&&e.matchId&&(ea(),await n.push(`/jeu/${e.matchId}`))}catch(e){j.value=e.message,G.value=!0}},Ee=async e=>{if(!(!l.value||!M.value)){R.value="",he.value=!1;try{const t=await ca(l.value,e);K(t),e==="draw"?R.value="Match nul enregistre.":e==="timeout"?R.value="Temps ecoule.":R.value="Match termine.",me({name:"finish_game",payload:{matchId:l.value,result:e}})}catch(t){R.value=t.message,he.value=!0}}},$t=async()=>{if(!B.value){if(ee(),M.value){await Ee("timeout");return}X.value=!0,le.value="Temps ecoule. Match termine.",pe.value=!0,me({payload:{matchId:l.value||"local"}})}},Rt=(e,t)=>{if(!St.value)return;if(!P.value){if(!t||!Ge(t,C.value))return;P.value=e;return}if(e===P.value){P.value=null;return}const i=Ve.value.find(f=>f.to===e);if(!i){t&&Ge(t,C.value)&&(P.value=e);return}if(M.value){Pt(i);return}Ot(i)},Bt=async()=>{if(M.value){if(B.value)return;await Ee("resign");return}me({payload:{matchId:l.value||"local"}}),await n.push("/dashboard")},Ut=async()=>{if(M.value){if(B.value)return;await Ee("draw");return}me({payload:{matchId:l.value||"local"}}),await n.push("/dashboard")},Dt=async()=>{await n.push("/dashboard")};et(()=>w.value.length,async()=>{await tt(),W.value&&(W.value.scrollTop=W.value.scrollHeight)}),Qt(()=>{ge(),ue(),ke(),ee()});const Ft=h(()=>bt.flatMap((e,t)=>Fe.map((i,f)=>{const d=re.value[t]?.[f]??"",S=`${i}${e}`,ve=(t+f)%2===1,de=d?d===d.toUpperCase()?"light":"dark":"",A=P.value===S,U=Ct.value.has(S),_e=ce.value?.from===S||ce.value?.to===S,Vt=ce.value?.to===S,Wt=d?`${S} ${_t[d]??"piece"}`:`${S} vide`;return{id:S,piece:d,symbol:kt[d]??"",dark:ve,tone:de,isSelected:A,isTarget:U,isLast:_e,isArrival:Vt,ariaLabel:Wt}})));return(e,t)=>(b(),zt(na,{eyebrow:"Partie",title:`Match ${l.value||"Libre"}`,subtitle:`Mode ${dt.value} - ${ye.value} - Cadence ${be.value}`},{default:Ht(()=>[a("section",ha,[a("div",pa,[a("div",wa,[a("div",ya,[a("div",null,[t[1]||(t[1]=a("p",{class:"panel-title"},"Plateau",-1)),a("h3",ba,"Tour: "+m(C.value==="white"?"Blancs":"Noirs"),1)]),a("span",ga,m(J.value==="JcJ"?"En ligne":"Local"),1)]),Je.value?(b(),k("p",ka,m(Je.value),1)):x("",!0),y.value?(b(),k("p",_a,m(y.value),1)):x("",!0),le.value?(b(),k("p",{key:2,class:$(["form-message",pe.value?"form-message--error":"form-message--success"])},m(le.value),3)):x("",!0),a("div",Ma,[a("div",{class:$(["player-chip",C.value==="white"&&"player-chip--active"])},[a("div",Ca,m(Ke(We.value)),1),a("div",Sa,[a("p",Na,m(We.value),1),t[2]||(t[2]=a("p",{class:"player-meta"},"Blancs",-1))]),a("div",{class:$(["player-clock",Ue(T.value)])},m(wt.value),3)],2),t[4]||(t[4]=a("span",{class:"vs-pill"},"VS",-1)),a("div",{class:$(["player-chip",C.value==="black"&&"player-chip--active"])},[a("div",La,m(Ke(je.value)),1),a("div",Ia,[a("p",Ta,m(je.value),1),t[3]||(t[3]=a("p",{class:"player-meta"},"Noirs",-1))]),a("div",{class:$(["player-clock",Ue(E.value)])},m(yt.value),3)],2)]),a("div",Ea,[a("div",xa,[(b(!0),k(Oe,null,xe(Ft.value,i=>(b(),k("button",{key:i.id,type:"button",class:$(["square",i.dark?"square--dark":"square--light",i.isLast?"square--last":"",i.isArrival?"square--arrival":"",i.isSelected?"square--selected":"",i.isTarget?"square--target":""]),"aria-label":i.ariaLabel,"aria-pressed":i.isSelected,role:"gridcell",onClick:f=>Rt(i.id,i.piece)},[i.piece?(b(),k("span",{key:0,class:$(["piece",i.tone==="light"?"piece--light":"piece--dark",i.isArrival?"piece--impact":""])},m(i.symbol),3)):x("",!0)],10,Oa))),128))])])]),a("div",Pa,[t[7]||(t[7]=a("div",null,[a("p",{class:"panel-title"},"Actions"),a("h3",{class:"panel-headline"},"Fin de match"),a("p",{class:"panel-sub"},"Gerez la partie en cours en un clic.")],-1)),a("button",{class:"button-ghost game-action",type:"button",disabled:B.value,onClick:Bt}," Abandonner ",8,Aa),a("button",{class:"button-ghost game-action",type:"button",disabled:B.value,onClick:Ut}," Match Nul ",8,Ja),R.value?(b(),k("p",{key:0,class:$(["form-message",he.value?"form-message--error":"form-message--success"])},m(R.value),3)):x("",!0),M.value&&B.value?(b(),k("div",$a,[t[5]||(t[5]=a("p",{class:"panel-title"},"Revanche",-1)),t[6]||(t[6]=a("p",{class:"panel-sub"},"Proposez une nouvelle partie a votre adversaire.",-1)),a("div",{class:"game-rematch-actions"},[a("button",{class:"button-primary",type:"button",onClick:Jt}," Proposer une revanche "),a("button",{class:"button-ghost",type:"button",onClick:Dt}," Retour au tableau ")]),j.value?(b(),k("p",{key:0,class:$(["form-message",G.value?"form-message--error":"form-message--success"])},m(j.value),3)):x("",!0)])):x("",!0)])]),a("div",Ra,[t[11]||(t[11]=a("div",{class:"panel-header"},[a("div",null,[a("p",{class:"panel-title"},"Commandes"),a("h3",{class:"panel-headline"},"Gestion du match")])],-1)),a("div",Ba,[a("div",null,[a("p",Ua,m(mt.value),1),a("p",Da,m(Y.value==="white"?"Blancs":"Noirs"),1)]),a("div",null,[a("p",Fa,m(ft.value),1),a("p",Va,m(ye.value),1)]),a("div",null,[t[8]||(t[8]=a("p",{class:"metric-label"},"Cadence",-1)),a("p",Wa,m(be.value),1)])]),a("div",ja,[t[9]||(t[9]=a("p",{class:"panel-title"},"Historique",-1)),a("div",Ka,[Z.value.length?x("",!0):(b(),k("div",qa,"Aucun coup joue.")),(b(!0),k(Oe,null,xe(Z.value,i=>(b(),k("div",{key:i.ply,class:"move-item"},[a("span",Qa,"#"+m(i.ply),1),a("span",za,m(i.side==="white"?"Blancs":"Noirs"),1),a("span",Ha,m(i.notation),1)]))),128))])]),M.value?(b(),k("div",Ga,[t[10]||(t[10]=a("p",{class:"panel-title"},"Chat",-1)),a("div",{ref_key:"chatListRef",ref:W,class:"chat-list"},[w.value.length?x("",!0):(b(),k("div",Xa,"Aucun message.")),(b(!0),k(Oe,null,xe(w.value,i=>(b(),k("div",{key:i.id,class:"chat-item"},[a("div",Ya,[a("span",Za,m(i.userName),1),a("span",es,m(At(i.createdAt)),1)]),a("p",ts,m(i.message),1)]))),128))],512),a("div",as,[Gt(a("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>z.value=i),type:"text",placeholder:"Ecrire un message...","aria-label":"Message",disabled:H.value||F.value,onKeydown:Yt(Zt(Xe,["prevent"]),["enter"])},null,40,ss),[[Xt,z.value]]),a("button",{class:"button-primary",type:"button",disabled:H.value||F.value||!z.value.trim(),onClick:Xe},m(H.value?"Envoi...":"Envoyer"),9,ns)]),se.value?(b(),k("p",ls,m(se.value),1)):x("",!0)])):x("",!0)])])]),_:1},8,["title","subtitle"]))}});export{cs as default};
