import{d as H,h as i,i as c,K as J,D as K,A as T,w as G,o as l,b as a,c as n,l as h,t as o,x as w,F as Q,r as W,N as X,f as Y}from"./index-DDgC0ReB.js";import{_ as Z,r as ee,a as R,b as ae,d as se,c as te,g as le,e as ne}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DlTTJkfp.js";import"./brand-icon-DO1QUDMu.js";import"./auth-CjXYnRhk.js";const oe={class:"profile-public-grid"},ue={key:0,class:"panel profile-card"},re={key:1,class:"panel profile-card"},ie={class:"form-message form-message--error"},ce={key:2,class:"panel profile-card profile-public"},de={class:"panel-header profile-public-header"},ve={class:"panel-headline"},pe={class:"panel-sub"},fe={class:"public-avatar"},me={class:"public-stats"},he={class:"stat-chip"},ge={class:"stat-chip-value"},be={class:"stat-chip-value"},_e={class:"stat-chip"},ye={class:"stat-chip-value"},ke={class:"stat-chip"},Se={class:"stat-chip-value"},we={class:"public-badges"},Ce={key:0,class:"panel-sub"},Fe={key:1,class:"form-message form-message--error"},Be={key:2,class:"badge-grid"},Pe={class:"badge-icon"},Re={class:"badge-content"},Ie={class:"badge-label"},Ae={class:"badge-desc"},Ee={class:"badge-value"},je={key:3,class:"empty-state"},Le={key:0,class:"public-actions"},Me={key:2,class:"public-action-group"},De=["disabled"],Ve=H({__name:"UserProfileView",setup(Ne){const I=J(),A=Y(),s=i(null),k=i([]),S=i(!1),g=i(""),C=i(!1),p=i(""),u=i(""),r=i(!1),d=i(""),f=i(!1),B=c(()=>String(I.params.id??"")),b=c(()=>s.value?.friendStatus??"none"),E=c(()=>b.value==="self"),F=c(()=>b.value==="friends"),j=c(()=>b.value==="outgoing"),L=c(()=>b.value==="incoming"),P=c(()=>s.value?.isOnline),_=c(()=>typeof P.value=="boolean"),y=c(()=>P.value===!0),M=c(()=>{const e=s.value?.name?.trim()??"";return e&&e.split(" ").filter(Boolean).slice(0,2).map(t=>t[0]?.toUpperCase()??"").join("")||"?"}),D=e=>e==="streak"?"S":e==="tournament"?"T":e==="fairplay"?"F":"B",N=async e=>{S.value=!0,g.value="";try{k.value=await ne(e)}catch(t){g.value=t.message,k.value=[]}finally{S.value=!1}},v=()=>{u.value="",r.value=!1,d.value="",f.value=!1},q=async()=>{v(),p.value="",s.value=null;const e=B.value;if(!e){p.value="Profil introuvable.";return}C.value=!0;try{const t=await le(e);t?(s.value=t,await N(e)):p.value="Profil introuvable."}catch(t){p.value=t.message}finally{C.value=!1}},x=async()=>{if(s.value){v();try{const e=await ee(s.value.id);u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},O=async()=>{if(s.value){v();try{const e=await R(s.value.id,"accept");u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},U=async()=>{if(s.value){v();try{const e=await R(s.value.id,"decline");u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},V=async()=>{if(s.value){v();try{const e=await ae(s.value.id);u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},z=async()=>{if(s.value){v();try{const e=await se(s.value.id);u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},$=async()=>{if(s.value){if(v(),!F.value){d.value="Ajoutez ce joueur en ami pour lancer un match.",f.value=!0;return}if(_.value&&!y.value){d.value="Ce joueur est hors ligne.",f.value=!0;return}try{const e=await te(s.value.id);d.value=e.message,f.value=!e.ok,e.ok&&e.status==="accepted"&&e.matchId&&(X(),await A.push(`/jeu/${e.matchId}`))}catch(e){d.value=e.message,f.value=!0}}};return K(B,q,{immediate:!0}),(e,t)=>(l(),T(Z,{eyebrow:"Joueur",title:s.value?.name??"Profil joueur",subtitle:s.value?.title||"Profil public"},{default:G(()=>[a("section",oe,[C.value?(l(),n("div",ue,[...t[0]||(t[0]=[a("p",{class:"panel-title"},"Chargement",-1),a("p",{class:"panel-sub"},"Recuperation du profil en cours.",-1)])])):p.value?(l(),n("div",re,[a("p",ie,o(p.value),1)])):s.value?(l(),n("div",ce,[a("div",de,[a("div",null,[t[1]||(t[1]=a("p",{class:"panel-title"},"Profil public",-1)),a("h2",ve,o(s.value.name),1),a("p",pe,o(s.value.motto||"Aucune devise renseignee."),1)]),a("div",fe,o(M.value),1)]),a("div",me,[a("div",he,[t[2]||(t[2]=a("span",{class:"stat-chip-label"},"Elo",-1)),a("span",ge,o(s.value.rating),1)]),a("div",{class:w(["stat-chip",_.value?y.value?"stat-chip--online":"stat-chip--offline":"stat-chip--unknown"])},[t[3]||(t[3]=a("span",{class:"stat-chip-label"},"Statut",-1)),a("span",be,o(_.value?y.value?"En ligne":"Hors ligne":"Statut inconnu"),1)],2),a("div",_e,[t[4]||(t[4]=a("span",{class:"stat-chip-label"},"Localisation",-1)),a("span",ye,o(s.value.location||"Non renseignee"),1)]),a("div",ke,[t[5]||(t[5]=a("span",{class:"stat-chip-label"},"Derniere activite",-1)),a("span",Se,o(s.value.lastSeen||"Non renseignee"),1)])]),a("div",we,[t[6]||(t[6]=a("p",{class:"panel-title"},"Badges",-1)),t[7]||(t[7]=a("p",{class:"panel-sub"},"Series, tournois et fair-play.",-1)),S.value?(l(),n("p",Ce,"Chargement des badges...")):g.value?(l(),n("p",Fe,o(g.value),1)):(l(),n("div",Be,[(l(!0),n(Q,null,W(k.value,m=>(l(),n("article",{key:m.key,class:w(["badge-card",!m.earned&&"badge-card--locked"])},[a("div",Pe,o(D(m.key)),1),a("div",Re,[a("p",Ie,o(m.label),1),a("p",Ae,o(m.description),1),a("p",Ee,o(m.value),1)])],2))),128))])),!S.value&&!g.value&&!k.value.length?(l(),n("p",je," Aucun badge disponible. ")):h("",!0)]),E.value?h("",!0):(l(),n("div",Le,[b.value==="none"?(l(),n("button",{key:0,class:"button-primary",type:"button",onClick:x}," Demander en ami ")):j.value?(l(),n("button",{key:1,class:"button-ghost",type:"button",onClick:V}," Annuler la demande ")):L.value?(l(),n("div",Me,[a("button",{class:"button-primary",type:"button",onClick:O}," Accepter "),a("button",{class:"button-ghost",type:"button",onClick:U}," Refuser ")])):F.value?(l(),n("button",{key:3,class:"button-ghost",type:"button",onClick:z}," Retirer des amis ")):h("",!0),a("button",{class:"button-primary",type:"button",disabled:!F.value||_.value&&!y.value,onClick:$},o(_.value?y.value?"Lancer un match":"Indisponible":"Lancer un match"),9,De)])),u.value?(l(),n("p",{key:1,class:w(["form-message",r.value?"form-message--error":"form-message--success"])},o(u.value),3)):h("",!0),d.value?(l(),n("p",{key:2,class:w(["form-message",f.value?"form-message--error":"form-message--success"])},o(d.value),3)):h("",!0)])):h("",!0)])]),_:1},8,["title","subtitle"]))}});export{Ve as default};
