import{J as l,I as t,a0 as o,a1 as n,a2 as u,N as c}from"./index-DDgC0ReB.js";const i=()=>{u(),c()},g=async()=>{try{l()&&await t("auth-logout",{method:"POST"})}catch{}finally{o(null),n(),i()}},h=async()=>{if(!l())return null;try{const s=await t("auth-session");return s.ok?s.user??null:null}catch{return null}},k=async(s,a,e)=>{if(!s||!a||!e)return{ok:!1,message:"Veuillez remplir tous les champs."};try{const r=await t("auth-register",{method:"POST",body:JSON.stringify({email:s.trim(),password:a,displayName:e.trim()})});return r.ok&&r.token&&(o(r.token),n(),i()),{ok:r.ok,message:r.message,user:r.user}}catch(r){return{ok:!1,message:r.message}}},f=async(s,a)=>{if(!s||!a)return{ok:!1,message:"Veuillez remplir tous les champs."};try{const e=await t("auth-login",{method:"POST",body:JSON.stringify({email:s.trim(),password:a})});return e.ok&&e.token&&(o(e.token),n(),i()),{ok:e.ok,message:e.message,user:e.user}}catch(e){return{ok:!1,message:e.message}}},y=s=>s.trim().toLowerCase()?{ok:!0,message:"Si un compte existe, un lien de reinitialisation a ete envoye."}:{ok:!1,message:"Veuillez saisir un email."},p=async(s,a)=>{if(!s||!a)return{ok:!1,message:"Veuillez remplir tous les champs."};try{const e=await t("auth-password",{method:"POST",body:JSON.stringify({currentPassword:s,nextPassword:a})});return{ok:e.ok,message:e.message}}catch(e){return{ok:!1,message:e.message}}};export{y as a,g as c,h as g,f as l,k as r,p as u};
