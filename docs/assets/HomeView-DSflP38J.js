import{d as re,e as w,p as n,f as de,G as ce,s as ue,w as r,y as pe,o as a,i as c,b as e,c as o,a as m,t as l,F as h,u,x as g,z as _,n as C,g as z,q as ve}from"./vendor-vue-DHDwDR0M.js";import{_ as me}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CAFU19Jj.js";import{_ as he}from"./AppModal.vue_vue_type_script_setup_true_lang-CWrUK09g.js";import{g as ge,d as _e,e as V}from"./index-D5r2B9WW.js";import{g as be}from"./leaderboard-DGhRtcN0.js";import{s as fe}from"./stats-DDjpa0W3.js";import{g as ye,a as ke,s as we}from"./story-NDRLUkJb.js";import{g as Se}from"./pieceAssets-DL4XSxcU.js";import"./brand-icon-IDKxxvz3.js";const Ce={class:"onboarding-list"},Pe={class:"onboarding-step__title"},$e={class:"onboarding-step__text"},xe={class:"content-grid"},ze={class:"left-column"},Be={class:"panel hero-card reveal"},je={class:"hero-header"},Le={class:"hero-actions"},Me={class:"hero-body"},Ne={class:"board","aria-hidden":"true"},Ve={class:"board-grid"},De=["src"],Ee={class:"hero-metrics"},Re={class:"metric-label"},Ae={class:"metric-value"},Te={class:"metric-note"},qe={class:"rubric-grid"},Ie={class:"rubric-title"},Je={class:"rubric-sub"},Oe={class:"card-actions"},Fe={class:"panel table-card reveal delay-2"},Ke={class:"panel-header"},Ge={class:"table-wrap"},Qe={key:0},Ue={class:"right-column"},He={class:"panel rating-card reveal"},We={class:"rating-header"},Xe={class:"rating-meta"},Ye={class:"rating-ring"},Ze={class:"ring-center"},et={class:"ring-score"},tt={class:"rating-footer"},st={class:"metric-value"},lt={class:"metric-value"},at={class:"panel reveal delay-1"},ot={class:"onboarding-list"},it={class:"checklist-row"},nt={class:"onboarding-step__title"},rt={class:"card-actions"},dt=["onClick"],ct={class:"panel reveal delay-2"},ut={key:0,class:"session-item"},pt={class:"session-title"},vt={class:"session-time"},mt={class:"badge-soft"},ht={class:"card-actions"},gt={class:"panel focus-card reveal delay-2"},_t={key:0,class:"progress-list"},bt={class:"progress-labels"},ft={class:"progress-bar"},yt={key:1,class:"panel-sub"},kt={class:"panel leaderboard-card reveal delay-3"},wt={class:"panel-header"},St={key:0,class:"leaderboard-list"},Ct={class:"leaderboard-user"},Pt={class:"leaderboard-avatar"},$t={class:"leaderboard-name"},xt={class:"leaderboard-meta"},zt={class:"leaderboard-delta"},Bt={key:1,class:"panel-sub"},D="warchess.onboarding.dismissed",E="warchess.checklist.completed",R="warchess.resume.checked",jt="f7",It=re({__name:"HomeView",setup(Lt){const f=w(null),S=w([]),B=w([]),A=pe(),T={id:"",name:"Invite",title:"",rating:1200,motto:"",location:"",lastSeen:"",email:"",avatarUrl:""},p=n(()=>f.value?.profile??T),j=n(()=>f.value?.goals??[]),q=n(()=>f.value?`Bonjour, ${f.value.profile.name||"joueur"}`:"Bonjour"),I=n(()=>f.value?.profile.motto??"Pret pour votre session du jour ?"),y=w(!1),J=[{title:"Choisir une session",text:"Duel, entrainement ou histoire selon votre objectif."},{title:"Jouer avec intention",text:"Lancez votre partie et suivez chaque tempo en direct."},{title:"Noter et progresser",text:"Relisez les coups critiques et ajustez votre plan."}],d=w([]),O=i=>{if(typeof window>"u")return[];try{const t=window.localStorage.getItem(i);return t?JSON.parse(t):[]}catch{return[]}},F=(i,t)=>{if(!(typeof window>"u"))try{window.localStorage.setItem(i,t)}catch{}},K=n(()=>{const i=!!(p.value.name&&p.value.name!=="Invite"),t=S.value.length>0,s=d.value.includes("friend");return[{id:"profile",title:"Completer le profil",done:i||d.value.includes("profile"),to:"/profile"},{id:"match",title:"Jouer une partie",done:t||d.value.includes("match"),to:"/matchs"},{id:"friend",title:"Ajouter un ami",done:s,to:"/amis"}]}),G=i=>{d.value.includes(i)?d.value=d.value.filter(t=>t!==i):d.value=[...d.value,i],F(E,JSON.stringify(d.value))},Q=async()=>{if(typeof window>"u"||window.sessionStorage.getItem(R)||(window.sessionStorage.setItem(R,"1"),!V()))return;const i=S.value.find(t=>t.status==="started");i&&await A.push(`/jeu/${i.id}`)},U=[{title:"Session rapide",description:"Lancez un duel classe ou amical.",to:"/matchs"},{title:"Chronique",description:"Poursuivez la campagne chapitre par chapitre.",to:"/histoire"},{title:"Carnet d analyse",description:"Revoyez vos parties et vos tendances.",to:"/profil/analyse"},{title:"Table des maitres",description:"Situez votre Elo dans la ligue.",to:"/leaderboard"}],k=n(()=>fe(S.value)),H=n(()=>[{label:"Elo",value:p.value.rating.toString(),detail:p.value.title||"Niveau actuel"},{label:"Winrate",value:`${k.value.winRate}%`,detail:`${k.value.wins}/${k.value.total} victoires`},{label:"Serie",value:`${k.value.streak} victoires`,detail:"Streak actif"},{label:"Elo delta",value:`${k.value.totalEloDelta>=0?"+":""}${k.value.totalEloDelta}`,detail:"30 derniers jours"}]),L=n(()=>S.value.slice(0,6)),W={waiting:"En attente",ready:"Pret",started:"En cours",finished:"Termine",aborted:"Annule"},P=ke(),X=w(ye()),v=n(()=>{if(!P.length)return null;const i=new Set(X.value.completed);return P.find(t=>!i.has(t.id))??P[0]??null}),Y=n(()=>v.value?`/histoire/${v.value.id}`:"/histoire"),M=n(()=>B.value.slice(0,5)),Z=i=>{we(i)};de(async()=>{f.value=await ge(),S.value=await _e(),V()&&(B.value=await be("global",1,10)),typeof window<"u"&&!window.localStorage.getItem(D)&&(y.value=!0),d.value=O(E),await Q()});const N=()=>{y.value=!1};ce(y,(i,t)=>{t&&!i&&typeof window<"u"&&window.localStorage.setItem(D,"1")});const ee=["a","b","c","d","e","f","g","h"],te=[8,7,6,5,4,3,2,1],se={p:"p",r:"r",n:"n",b:"b",q:"q",k:"k",P:"P",R:"R",N:"N",B:"B",Q:"Q",K:"K"},le=[["r","n","b","q","k","b","n","r"],["p","p","p","","","p","p","p"],["","","","p","","","",""],["","","","","p","","",""],["","","P","","P","","",""],["","","","N","","N","",""],["P","P","","P","","P","P","P"],["R","","B","Q","K","B","","R"]],ae=new Set(["e2","e4"]),oe=te.flatMap((i,t)=>ee.map((s,$)=>{const b=le[t]?.[$]??"",x=`${s}${i}`,ie=(t+$)%2===1,ne=b?b===b.toUpperCase()?"light":"dark":"";return{id:x,dark:ie,piece:b,tone:ne,symbol:se[b]??"",image:b?Se(b):"",isLastMove:ae.has(x),isFocus:x===jt}}));return(i,t)=>(a(),ue(me,{eyebrow:"Bon retour",title:q.value,subtitle:I.value},{default:r(()=>[c(he,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),title:"Demarrage rapide"},{footer:r(()=>[e("button",{class:"button-ghost",type:"button",onClick:N},"Plus tard"),c(u(g),{class:"button-primary",to:"/matchs",onClick:N},{default:r(()=>[...t[3]||(t[3]=[_("Jouer maintenant",-1)])]),_:1})]),default:r(()=>[e("ol",Ce,[(a(),o(h,null,m(J,s=>e("li",{key:s.title,class:"onboarding-step"},[e("p",Pe,l(s.title),1),e("p",$e,l(s.text),1)])),64))])]),_:1},8,["modelValue"]),e("section",xe,[e("div",ze,[e("div",Be,[e("div",je,[t[5]||(t[5]=e("div",null,[e("p",{class:"panel-title"},"Mission du jour"),e("h2",{class:"panel-headline"},"Table de commandement"),e("p",{class:"panel-sub"}," Suivez votre forme, vos matchs et votre programme d etude depuis un seul espace. ")],-1)),e("div",Le,[c(u(g),{class:"button-primary",to:"/matchs"},{default:r(()=>[...t[4]||(t[4]=[_("Demarrer un duel",-1)])]),_:1}),e("button",{class:"button-ghost",type:"button",onClick:t[1]||(t[1]=s=>y.value=!0)}," Voir le guide ")])]),e("div",Me,[e("div",Ne,[e("div",Ve,[(a(!0),o(h,null,m(u(oe),s=>(a(),o("div",{key:s.id,class:C(["square",s.dark?"square--dark":"square--light",s.isLastMove?"square--last":"",s.isFocus?"square--focus":""])},[s.piece&&s.image?(a(),o("img",{key:0,src:s.image,alt:"","aria-hidden":"true",class:C(["piece","piece-img",s.tone==="light"?"piece--light":"piece--dark"])},null,10,De)):s.piece?(a(),o("span",{key:1,class:C(["piece",s.tone==="light"?"piece--light":"piece--dark"])},l(s.symbol),3)):z("",!0)],2))),128))])]),e("div",Ee,[(a(!0),o(h,null,m(H.value,s=>(a(),o("div",{key:s.label,class:"metric-card"},[e("p",Re,l(s.label),1),e("p",Ae,l(s.value),1),e("p",Te,l(s.detail),1)]))),128))])])]),e("div",qe,[(a(),o(h,null,m(U,s=>e("article",{key:s.title,class:"panel rubric-card reveal delay-1"},[e("p",Ie,l(s.title),1),e("p",Je,l(s.description),1),e("div",Oe,[c(u(g),{class:"button-ghost",to:s.to},{default:r(()=>[...t[6]||(t[6]=[_("Ouvrir",-1)])]),_:1},8,["to"])])])),64))]),e("div",Fe,[e("div",Ke,[t[8]||(t[8]=e("div",null,[e("p",{class:"panel-title"},"Journal recent"),e("h3",{class:"panel-headline"},"Chronologie JcJ")],-1)),c(u(g),{class:"range-pill",to:"/matchs"},{default:r(()=>[...t[7]||(t[7]=[_("Voir tout",-1)])]),_:1})]),e("div",Ge,[e("table",null,[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th",null,"Match"),e("th",null,"Adversaire"),e("th",null,"Statut"),e("th",null,"Cadence"),e("th",null,"Dernier coup")])],-1)),e("tbody",null,[(a(!0),o(h,null,m(L.value,s=>(a(),o("tr",{key:s.id},[e("td",null,l(s.id),1),e("td",null,l(s.opponent),1),e("td",null,l(W[s.status]??s.status),1),e("td",null,l(s.timeControl),1),e("td",null,l(s.lastMove||"-"),1)]))),128)),L.value.length?z("",!0):(a(),o("tr",Qe,[...t[9]||(t[9]=[e("td",{colspan:"5"},"Aucun match termine.",-1)])]))])])])])]),e("aside",Ue,[e("div",He,[e("div",We,[t[11]||(t[11]=e("p",{class:"panel-title"},"Score Elo",-1)),e("p",Xe,l(p.value.location||"Profil"),1)]),e("div",Ye,[t[13]||(t[13]=e("svg",{viewBox:"0 0 120 120","aria-hidden":"true"},[e("defs",null,[e("linearGradient",{id:"ratingGradient",x1:"0",y1:"0",x2:"1",y2:"1"},[e("stop",{offset:"0%","stop-color":"#4ade80"}),e("stop",{offset:"100%","stop-color":"#22c55e"})])]),e("circle",{cx:"60",cy:"60",r:"46",pathLength:"100",class:"ring-track"}),e("circle",{cx:"60",cy:"60",r:"46",pathLength:"100",class:"ring-value",stroke:"url(#ratingGradient)"})],-1)),e("div",Ze,[e("p",et,l(p.value.rating),1),t[12]||(t[12]=e("p",{class:"ring-label"},"Elo saison",-1))])]),e("div",tt,[e("div",null,[t[14]||(t[14]=e("p",{class:"metric-label"},"Titre",-1)),e("p",st,l(p.value.title||"---"),1)]),e("div",null,[t[15]||(t[15]=e("p",{class:"metric-label"},"Derniere activite",-1)),e("p",lt,l(p.value.lastSeen||"---"),1)])])]),e("div",at,[t[17]||(t[17]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Plan de progression"),e("h3",{class:"panel-headline"},"Rituels rapides")])],-1)),e("div",ot,[(a(!0),o(h,null,m(K.value,s=>(a(),o("div",{key:s.id,class:"onboarding-step checklist-step"},[e("div",it,[e("span",{class:C(["checklist-dot",s.done?"checklist-dot--done":""])},null,2),e("p",nt,l(s.title),1)]),e("div",rt,[c(u(g),{class:"button-ghost",to:s.to},{default:r(()=>[...t[16]||(t[16]=[_("Ouvrir",-1)])]),_:1},8,["to"]),e("button",{class:"button-ghost",type:"button",onClick:$=>G(s.id)},l(s.done?"Annuler":"Terminer"),9,dt)])]))),128))])]),e("div",ct,[t[20]||(t[20]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Chronique"),e("h3",{class:"panel-headline"},"Chapitre suivant")])],-1)),v.value?(a(),o("div",ut,[e("div",null,[e("p",pt,l(v.value.title),1),e("p",vt,l(v.value.summary),1)]),e("span",mt,l(v.value.difficulty),1)])):z("",!0),e("div",ht,[c(u(g),{class:"button-primary",to:Y.value,onClick:t[2]||(t[2]=s=>v.value&&Z(v.value.id))},{default:r(()=>[...t[18]||(t[18]=[_(" Continuer ",-1)])]),_:1},8,["to"]),c(u(g),{class:"button-ghost",to:"/histoire"},{default:r(()=>[...t[19]||(t[19]=[_("Voir tous les chapitres",-1)])]),_:1})])]),e("div",gt,[t[21]||(t[21]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Atelier d entrainement"),e("h3",{class:"panel-headline"},"Objectifs de la semaine")])],-1)),j.value.length?(a(),o("div",_t,[(a(!0),o(h,null,m(j.value,s=>(a(),o("div",{key:s.label,class:"progress-item"},[e("div",bt,[e("span",null,l(s.label),1),e("span",null,l(s.progress)+"%",1)]),e("div",ft,[e("span",{class:"progress-fill",style:ve({width:`${s.progress}%`})},null,4)])]))),128))])):(a(),o("p",yt,"Aucun objectif defini pour le moment."))]),e("div",kt,[e("div",wt,[t[23]||(t[23]=e("div",null,[e("p",{class:"panel-title"},"Classement"),e("h3",{class:"panel-headline"},"Table des maitres")],-1)),c(u(g),{class:"range-pill",to:"/leaderboard"},{default:r(()=>[...t[22]||(t[22]=[_("Voir le podium",-1)])]),_:1})]),M.value.length?(a(),o("div",St,[(a(!0),o(h,null,m(M.value,s=>(a(),o("div",{key:s.id,class:"leaderboard-item"},[e("div",Ct,[e("div",Pt,l(s.name.slice(0,1)),1),e("div",null,[e("p",$t,l(s.name),1),e("p",xt,"Elo "+l(s.rating),1)])]),e("span",zt,l(s.delta>=0?"+":"")+l(s.delta),1)]))),128))])):(a(),o("p",Bt,"Podium indisponible."))])])])]),_:1},8,["title","subtitle"]))}});export{It as default};
