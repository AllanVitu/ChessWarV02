import{d as j,e as n,p as E,f as U,h as Y,c as p,b as s,g as y,v as T,u as b,A as X,t as u,B as _,C as L,D as $,E as G,n as O,i as R,w as V,x as A,y as H,o as c,z as D}from"./vendor-vue-DHDwDR0M.js";import{s as J,n as K,l as Q,a as W,b as Z}from"./index-yjI6zOkV.js";const ee={class:"auth-orbit"},se={class:"panel auth-card auth-card--orbit"},te={class:"auth-stack"},ae={key:0,class:"form-message form-message--error",role:"status"},oe={class:"auth-status"},ne={class:"auth-status-count"},ie={class:"form-field"},re={class:"form-field"},le={class:"auth-input"},ue=["type"],de=["aria-pressed","aria-label"],pe=["disabled","aria-busy"],ce={key:0,class:"auth-progress","aria-hidden":"true"},ve={class:"auth-stat"},me={class:"auth-stat-value"},he={class:"auth-links"},ye=j({__name:"LoginView",setup(fe){const v=H(),B=X(),m=n(""),h=n(""),i=n(!1),d=n(""),f=n(!1),r=n(!1),a=n(null),x=["53% de victoires sur les parties rapides.","Ouverture la plus jouee : Italienne.","Moyenne de 32 coups par partie.","Taux de precision moyen : 87%.","Meilleure serie recente : 4 victoires."],I=E(()=>{const t=new Date,e=t.getFullYear()+t.getMonth()*31+t.getDate();return x[e%x.length]}),q=E(()=>{const e=Math.sin(new Date().getHours()/24*Math.PI*2);return Math.round(140+e*35)});let o=0,w=0,g=0,M=!1;const k=()=>{o=0,a.value&&(a.value.style.setProperty("--parallax-x",`${w}px`),a.value.style.setProperty("--parallax-y",`${g}px`))},C=t=>{if(!a.value)return;const e=a.value.getBoundingClientRect(),l=(t.clientX-e.left)/e.width-.5,N=(t.clientY-e.top)/e.height-.5,P=24;w=l*P*2,g=N*P*2,o||(o=window.requestAnimationFrame(k))},S=()=>{w=0,g=0,o||(o=window.requestAnimationFrame(k))},z=async()=>{d.value="",f.value=!1,r.value=!0;const t=await Q(m.value,h.value);if(r.value=!1,d.value=t.message,f.value=!t.ok,t.ok){W("Connexion reussie",t.message);const e=(()=>{if(typeof window>"u")return"";try{return window.sessionStorage.getItem("warchess.postLoginRedirect")??""}catch{return""}})();if(e){try{window.sessionStorage.removeItem("warchess.postLoginRedirect")}catch{}await v.push(e)}else await v.push("/dashboard");return}t.message&&Z("Connexion refusee",t.message)},F=async()=>{J(),K("Mode invite","Vous jouez en local sans compte."),await v.push("/dashboard")};return U(()=>{if(typeof window>"u")return;const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e=window.matchMedia("(pointer: fine)").matches;t||!e||a.value&&(M=!0,a.value.addEventListener("pointermove",C),a.value.addEventListener("pointerleave",S))}),Y(()=>{o&&window.cancelAnimationFrame(o),M&&a.value&&(a.value.removeEventListener("pointermove",C),a.value.removeEventListener("pointerleave",S))}),(t,e)=>(c(),p("div",{ref_key:"authPageRef",ref:a,class:"auth-page auth-page--solo"},[e[18]||(e[18]=s("div",{class:"auth-wordmark","aria-hidden":"true"},null,-1)),e[19]||(e[19]=s("div",{class:"auth-silhouette auth-silhouette--pawn","aria-hidden":"true"},null,-1)),e[20]||(e[20]=s("div",{class:"auth-silhouette auth-silhouette--knight","aria-hidden":"true"},null,-1)),s("div",ee,[e[17]||(e[17]=s("div",{class:"auth-halo","aria-hidden":"true"},null,-1)),s("div",se,[s("div",te,[e[12]||(e[12]=s("p",{class:"eyebrow"},"Connexion",-1)),e[13]||(e[13]=s("p",{class:"auth-kicker"},"Retour sur le plateau",-1)),e[14]||(e[14]=s("h1",{class:"auth-title"},"Reprendre votre partie",-1)),e[15]||(e[15]=s("p",{class:"subhead auth-subhead"}," Accedez a vos matchs en cours, vos invites d'amis et vos analyses. ",-1)),b(B).query.reason==="expired"?(c(),p("p",ae," Session expiree. Veuillez vous reconnecter. ")):y("",!0),s("div",oe,[e[3]||(e[3]=s("span",{class:"status-dot","aria-hidden":"true"},null,-1)),e[4]||(e[4]=s("span",null,"Serveur en ligne",-1)),s("span",ne,u(q.value)+" joueurs actifs",1)]),s("form",{class:"form-stack auth-form",onSubmit:_(z,["prevent"])},[s("label",ie,[e[5]||(e[5]=s("span",{class:"form-label"},"Email",-1)),L(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),class:"form-input",type:"email",autocomplete:"email",inputmode:"email",placeholder:"vous@exemple.com"},null,512),[[$,m.value]])]),s("label",re,[e[6]||(e[6]=s("span",{class:"form-label"},"Mot de passe",-1)),s("div",le,[L(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>h.value=l),class:"form-input",type:i.value?"text":"password",autocomplete:"current-password",placeholder:"********"},null,8,ue),[[G,h.value]]),s("button",{class:"auth-toggle",type:"button","aria-pressed":i.value,"aria-label":i.value?"Masquer le mot de passe":"Afficher le mot de passe",onClick:e[2]||(e[2]=l=>i.value=!i.value)},u(i.value?"Masquer":"Afficher"),9,de)])]),s("button",{class:"button-primary",type:"submit",disabled:r.value,"aria-busy":r.value},u(r.value?"Connexion...":"Se connecter"),9,pe),s("button",{class:"button-ghost",type:"button",onClick:F},"Jouer en invite"),r.value?(c(),p("div",ce,[...e[7]||(e[7]=[s("span",{class:"auth-progress__bar"},null,-1)])])):y("",!0),e[8]||(e[8]=s("p",{class:"auth-note"},"Connexion securisee et synchronisee sur tous vos appareils.",-1))],32),d.value?(c(),p("p",{key:1,class:O(["form-message",f.value?"form-message--error":"form-message--success"]),role:"status"},u(d.value),3)):y("",!0),s("div",ve,[e[9]||(e[9]=s("span",{class:"auth-stat-label"},"Stat du jour",-1)),s("span",me,u(I.value),1)]),e[16]||(e[16]=T('<div class="auth-chips"><div class="auth-chip"><span class="auth-chip-dot auth-chip-dot--match"></span> Matchs amis </div><div class="auth-chip"><span class="auth-chip-dot auth-chip-dot--analysis"></span> Analyse IA </div><div class="auth-chip"><span class="auth-chip-dot auth-chip-dot--rank"></span> Classements </div></div>',1)),s("div",he,[R(b(A),{to:"/mot-de-passe-oublie"},{default:V(()=>[...e[10]||(e[10]=[D("Mot de passe oublie ?",-1)])]),_:1}),R(b(A),{to:"/inscription"},{default:V(()=>[...e[11]||(e[11]=[D("Creer un compte",-1)])]),_:1})])])])])],512))}});export{ye as default};
