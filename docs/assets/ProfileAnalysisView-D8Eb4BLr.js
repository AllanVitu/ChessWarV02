import{d as I,p as i,c as o,o as n,F as M,a as $,e as S,f as H,s as K,w as A,b as e,t as l,n as Q,i as C,q as U,z as D,u as O,x as R}from"./vendor-vue-DHDwDR0M.js";import{_ as X}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DWqoZ-Ld.js";import{g as Y,d as Z}from"./index-C1qQ0MbN.js";import{f as ee,b as se,s as te}from"./stats-DDjpa0W3.js";import"./brand-icon-IDKxxvz3.js";const ae={class:"line-chart"},le=["viewBox"],ne=["d","stroke"],F=600,B=220,P=24,oe=I({__name:"LineChart",props:{labels:{},datasets:{}},setup(w){const r=w,d=i(()=>r.datasets.flatMap(c=>c.data)),_=i(()=>d.value.length?Math.min(...d.value):0),m=i(()=>d.value.length?Math.max(...d.value):1),f=i(()=>{const c=m.value-_.value;return c===0?1:c}),E=c=>{if(!c.length)return"";const h=c.length,g=h>1?(F-P*2)/(h-1):0;return c.map((V,v)=>{const y=P+g*v,u=B-P-(V-_.value)/f.value*(B-P*2);return`${v===0?"M":"L"}${y} ${u}`}).join(" ")},x=i(()=>r.datasets.map(c=>({label:c.label,color:c.color??"rgba(148, 163, 184, 0.9)",path:E(c.data)})));return(c,h)=>(n(),o("div",ae,[(n(),o("svg",{viewBox:`0 0 ${F} ${B}`,role:"img","aria-label":"Graphique de progression"},[(n(!0),o(M,null,$(x.value,g=>(n(),o("path",{key:g.label,d:g.path,fill:"none",stroke:g.color,"stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},null,8,ne))),128))],8,le))]))}}),ie=(w,r)=>{const d=w.__vccOpts||w;for(const[_,m]of r)d[_]=m;return d},re=ie(oe,[["__scopeId","data-v-fb060409"]]),ce={class:"content-grid"},ue={class:"left-column"},de={class:"panel hero-card"},ve={class:"panel-header"},pe={class:"badge-soft"},he={class:"stats-grid"},_e={class:"stat-label"},me={class:"stat-value"},ge={class:"stat-meta"},be={class:"stat-change"},fe={class:"panel elo-panel"},ye={class:"panel-header"},ke={class:"segmented elo-periods"},Me=["onClick"],$e={class:"elo-chart"},we={class:"elo-range"},xe={class:"elo-metrics"},je={class:"metric-card"},Se={class:"metric-value"},Ae={class:"metric-card"},Ce={class:"metric-value"},Pe={class:"metric-card"},Ee={class:"metric-value"},Ve={class:"period-metrics"},De={class:"metric-label"},Oe={class:"metric-value"},Re={class:"metric-note"},Be={class:"panel"},Le={key:0,class:"progress-list analysis-progress"},qe={class:"progress-labels"},Ne={class:"progress-bar"},ze={key:1,class:"panel-sub"},Je={class:"panel"},Fe={key:0,class:"session-list"},Ie={class:"session-title"},Te={class:"session-time"},We={class:"badge-soft"},Ge={key:1,class:"panel-sub"},He={class:"right-column"},Ke={class:"panel"},Qe={class:"hero-metrics"},Ue={class:"metric-card"},Xe={class:"metric-value"},Ye={class:"metric-note"},Ze={class:"metric-card"},es={class:"metric-value"},ss={class:"metric-note"},ts={class:"metric-card"},as={class:"metric-value"},ls={class:"panel"},ns={class:"card-actions"},ds=I({__name:"ProfileAnalysisView",setup(w){const r=S([]),d=S([]),_=S(1200),m=S("30j"),f=[{key:"7j",label:"7 jours",days:7},{key:"30j",label:"30 jours",days:30},{key:"90j",label:"90 jours",days:90}],E=f[1]??f[0],x=i(()=>f.find(a=>a.key===m.value)??E),c=i(()=>ee(d.value,x.value.days).reverse()),h=i(()=>se(c.value,_.value)),g=i(()=>h.value.map((a,s)=>`M${s+1}`)),V=i(()=>[{label:"Elo",data:h.value,color:"rgba(242, 167, 101, 0.85)"}]),v=i(()=>{const a=h.value.length?h.value:[0],s=Math.min(...a),t=Math.max(...a);return{min:s,max:t,start:a[0]??0,end:a[a.length-1]??0}}),y=a=>Math.round(a).toString(),u=i(()=>te(d.value)),T=i(()=>[{label:"Winrate",value:`${u.value.winRate}%`,detail:`${u.value.wins}/${u.value.total}`},{label:"Elo delta",value:`${u.value.totalEloDelta>=0?"+":""}${u.value.totalEloDelta}`,detail:"Sur 30 jours"},{label:"Precision",value:r.value.length?`${Math.round(r.value.reduce((a,s)=>a+(s.accuracy??0),0)/r.value.length)}%`:"0%",detail:"Moyenne parties"},{label:"Matchs JcJ",value:`${u.value.total}`,detail:"Historique"}]),L=i(()=>r.value.length?[{label:"Regularite",progress:Math.min(100,u.value.winRate)},{label:"Precision",progress:Math.min(100,Math.round(r.value.reduce((a,s)=>a+(s.accuracy??0),0)/r.value.length))}]:[]),q=i(()=>{if(!r.value.length)return[];const a=r.value.reduce((t,k)=>{const j=k.opening||"Inconnue";return t[j]=(t[j]??0)+1,t},{});return[{title:"Ouverture favorite",detail:Object.entries(a).sort((t,k)=>k[1]-t[1])[0]?.[0]??"---",tag:"Stable"}]}),W=i(()=>{const a=r.value,s=a.length;if(!s)return[{label:"Matchs joues",value:"0",note:"Aucune partie"},{label:"Taux de victoire",value:"0%",note:"0 victoires"},{label:"Precision moyenne",value:"0%",note:"---"},{label:"Ouverture favorite",value:"---",note:"---"}];const t=a.filter(p=>p.result==="win").length,k=Math.round(t/s*100),j=Math.round(a.reduce((p,b)=>p+(b.accuracy??0),0)/s),G=Math.round(a.reduce((p,b)=>p+(b.moves??0),0)/s),N=a.reduce((p,b)=>{const J=b.opening||"Inconnue";return p[J]=(p[J]??0)+1,p},{}),z=Object.entries(N).sort((p,b)=>b[1]-p[1])[0]?.[0]??"---";return[{label:"Matchs joues",value:`${s}`,note:`${t} victoires`},{label:"Taux de victoire",value:`${k}%`,note:`Moyenne ${G} coups`},{label:"Precision moyenne",value:`${j}%`,note:"Sur ce segment"},{label:"Ouverture favorite",value:z,note:`${N[z]??0} parties`}]});return H(async()=>{const a=await Y();r.value=a.games??[],_.value=a.profile.rating??1200,d.value=await Z()}),(a,s)=>(n(),K(X,{eyebrow:"Analyse",title:"Analyse du profil",subtitle:"Synthese de performance et tendances recentes.",breadcrumbs:[{label:"Profil",to:"/profile"},{label:"Analyse"}]},{default:A(()=>[e("section",ce,[e("div",ue,[e("div",de,[e("div",ve,[s[0]||(s[0]=e("div",null,[e("p",{class:"panel-title"},"Apercu general"),e("h2",{class:"panel-headline"},"Niveau et progression"),e("p",{class:"panel-sub"},"Suivi des stats cles sur vos 30 derniers matchs.")],-1)),e("span",pe,l(x.value.label),1)]),e("div",he,[(n(!0),o(M,null,$(T.value,t=>(n(),o("div",{key:t.label,class:"panel stat-card"},[e("p",_e,l(t.label),1),e("p",me,l(t.value),1),e("div",ge,[e("span",be,l(t.detail),1)])]))),128))])]),e("div",fe,[e("div",ye,[s[1]||(s[1]=e("div",null,[e("p",{class:"panel-title"},"Courbe Elo"),e("h3",{class:"panel-headline"},"Evolution recente"),e("p",{class:"panel-sub"},"Basee sur vos derniers matchs.")],-1)),e("div",ke,[(n(),o(M,null,$(f,t=>e("button",{key:t.key,type:"button",class:Q(["segmented-button",m.value===t.key&&"segmented-button--active"]),onClick:k=>m.value=t.key},l(t.label),11,Me)),64))])]),e("div",$e,[C(re,{labels:g.value,datasets:V.value},null,8,["labels","datasets"]),e("div",we,[e("span",null,l(y(v.value.min)),1),e("span",null,l(y(v.value.max)),1)])]),e("div",xe,[e("div",je,[s[2]||(s[2]=e("p",{class:"metric-label"},"Depart",-1)),e("p",Se,l(y(v.value.start)),1),s[3]||(s[3]=e("p",{class:"metric-note"},"Debut de periode",-1))]),e("div",Ae,[s[4]||(s[4]=e("p",{class:"metric-label"},"Fin",-1)),e("p",Ce,l(y(v.value.end)),1),s[5]||(s[5]=e("p",{class:"metric-note"},"Actuel",-1))]),e("div",Pe,[s[6]||(s[6]=e("p",{class:"metric-label"},"Variation",-1)),e("p",Ee,l(Math.round(v.value.end-v.value.start)>=0?"+":"")+l(Math.round(v.value.end-v.value.start)),1),s[7]||(s[7]=e("p",{class:"metric-note"},"Sur la periode",-1))])]),e("div",Ve,[(n(!0),o(M,null,$(W.value,t=>(n(),o("div",{key:t.label,class:"metric-card"},[e("p",De,l(t.label),1),e("p",Oe,l(t.value),1),e("p",Re,l(t.note),1)]))),128))])]),e("div",Be,[s[8]||(s[8]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Axes prioritaires"),e("h3",{class:"panel-headline"},"Progression ciblee")]),e("span",{class:"range-pill"},"Mensuel")],-1)),L.value.length?(n(),o("div",Le,[(n(!0),o(M,null,$(L.value,t=>(n(),o("div",{key:t.label,class:"progress-item"},[e("div",qe,[e("span",null,l(t.label),1),e("span",null,l(t.progress)+"%",1)]),e("div",Ne,[e("span",{class:"progress-fill",style:U({width:`${t.progress}%`})},null,4)])]))),128))])):(n(),o("p",ze,"Aucune donnee de progression disponible."))]),e("div",Je,[s[9]||(s[9]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Moments forts"),e("h3",{class:"panel-headline"},"Ce qui fonctionne")])],-1)),q.value.length?(n(),o("div",Fe,[(n(!0),o(M,null,$(q.value,t=>(n(),o("div",{key:t.title,class:"session-item"},[e("div",null,[e("p",Ie,l(t.title),1),e("p",Te,l(t.detail),1)]),e("span",We,l(t.tag),1)]))),128))])):(n(),o("p",Ge,"Aucun highlight pour le moment."))])]),e("aside",He,[e("div",Ke,[s[14]||(s[14]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Resume JcJ"),e("h3",{class:"panel-headline"},"Stats essentielles")])],-1)),e("div",Qe,[e("div",Ue,[s[10]||(s[10]=e("p",{class:"metric-label"},"Matchs termines",-1)),e("p",Xe,l(u.value.total),1),e("p",Ye,l(u.value.wins)+" victoires",1)]),e("div",Ze,[s[11]||(s[11]=e("p",{class:"metric-label"},"Winrate",-1)),e("p",es,l(u.value.winRate)+"%",1),e("p",ss,l(u.value.draws)+" nuls",1)]),e("div",ts,[s[12]||(s[12]=e("p",{class:"metric-label"},"Elo delta",-1)),e("p",as,l(u.value.totalEloDelta>=0?"+":"")+l(u.value.totalEloDelta),1),s[13]||(s[13]=e("p",{class:"metric-note"},"Sur 30 jours",-1))])])]),e("div",ls,[s[18]||(s[18]=e("div",{class:"panel-header"},[e("div",null,[e("p",{class:"panel-title"},"Navigation"),e("h3",{class:"panel-headline"},"Actions utiles")])],-1)),e("div",ns,[C(O(R),{class:"button-primary",to:"/matchs"},{default:A(()=>[...s[15]||(s[15]=[D("Voir historique",-1)])]),_:1}),C(O(R),{class:"button-ghost",to:"/leaderboard"},{default:A(()=>[...s[16]||(s[16]=[D("Classement",-1)])]),_:1}),C(O(R),{class:"button-ghost",to:"/profile"},{default:A(()=>[...s[17]||(s[17]=[D("Profil",-1)])]),_:1})])])])])]),_:1}))}});export{ds as default};
