import{d as k,e as z,p as S,s as P,w as c,o as u,b as s,i as h,t as a,z as b,u as p,x as f,c as g,a as L,n as $,F as x,y as D}from"./vendor-vue-DHDwDR0M.js";import{_ as R}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-wVOHqvGg.js";import{g as V,a as q,s as A,m as B}from"./story-NDRLUkJb.js";import{g as N}from"./puzzles-C5G97RSN.js";import"./index-DneDkzAD.js";import"./brand-icon-IDKxxvz3.js";const U={class:"story-layout"},F={class:"panel story-hero"},M={class:"story-hero__actions"},j=["disabled"],E={class:"story-grid"},H={class:"story-card__header"},I={class:"panel-title"},T={class:"panel-headline"},G={class:"panel-sub"},J={class:"story-meta"},K={class:"story-pill"},O={class:"story-pill"},Q={class:"story-pill"},W={class:"card-actions"},X=["disabled","onClick"],Y=["disabled","onClick"],ns=k({__name:"StoryView",setup(Z){const m=D(),n=q(),C=N(),r=z(V()),i=o=>o===1?!0:r.value.completed.includes(o-1),l=S(()=>n.find(o=>i(o.id)&&!r.value.completed.includes(o.id))??n[0]),y=()=>{try{window.sessionStorage.setItem("warchess.play.access","1")}catch{}},_=async o=>{const e=n.find(d=>d.id===o);if(!e||!i(e.id))return;y(),A(e.id);const t=new URLSearchParams({allow:"1",mode:"histoire",chapter:String(e.id),difficulty:e.difficulty.toLowerCase(),side:e.side,time:e.timeControl});await m.push(`/play?${t.toString()}`)},v=async()=>{y();const o=new URLSearchParams({allow:"1",mode:"local",puzzle:C.id,side:"Aleatoire",time:"10+0"});await m.push(`/play?${o.toString()}`)},w=o=>{r.value.completed=B(o)};return(o,e)=>(u(),P(R,{eyebrow:"Histoire",title:"Mode histoire",subtitle:"Progressez chapitre par chapitre dans une campagne dynamique."},{default:c(()=>[s("section",U,[s("article",F,[e[2]||(e[2]=s("div",null,[s("p",{class:"panel-title"},"Campagne"),s("h2",{class:"panel-headline"},"La chronique du royaume"),s("p",{class:"panel-sub"}," Chaque chapitre propose un objectif concret, une cadence adaptee et une progression sauvegardee. ")],-1)),s("div",M,[s("button",{class:"button-primary",type:"button",disabled:!l.value,onClick:e[0]||(e[0]=t=>l.value&&_(l.value.id))}," Continuer chapitre "+a(l.value?.id??1),9,j),s("button",{class:"button-ghost",type:"button",onClick:v}," Daily puzzle "),h(p(f),{class:"button-ghost",to:"/matchs"},{default:c(()=>[...e[1]||(e[1]=[b("Retour aux matchs",-1)])]),_:1})])]),s("div",E,[(u(!0),g(x,null,L(p(n),t=>(u(),g("article",{key:t.id,class:"panel story-card"},[s("div",H,[s("p",I,"Chapitre "+a(t.id),1),s("span",{class:$(["badge-soft",i(t.id)?"":"badge-soft--muted"])},a(i(t.id)?"Disponible":"Verrouille"),3)]),s("h3",T,a(t.title),1),s("p",G,a(t.summary),1),s("div",J,[s("span",K,"IA "+a(t.difficulty),1),s("span",O,"Cadence "+a(t.timeControl),1),s("span",Q,"Couleur "+a(t.side),1)]),s("div",W,[s("button",{class:"button-primary",type:"button",disabled:!i(t.id),onClick:d=>_(t.id)}," Lancer ",8,X),h(p(f),{class:"button-ghost",to:`/histoire/${t.id}`},{default:c(()=>[...e[3]||(e[3]=[b("Details",-1)])]),_:1},8,["to"]),s("button",{class:"button-ghost",type:"button",disabled:!i(t.id),onClick:d=>w(t.id)}," Marquer termine ",8,Y)])]))),128))])])]),_:1}))}});export{ns as default};
