import{d as G,e as i,p as c,A as H,G as J,s as T,w as K,o as l,b as a,c as n,g,t as o,n as w,F as Q,a as W,y as X}from"./vendor-vue-DHDwDR0M.js";import{_ as Y,r as Z,a as R,b as ee,d as ae,c as se,g as te,e as le}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-3Gta68jF.js";import{m as ne}from"./index-yjI6zOkV.js";import"./brand-icon-IDKxxvz3.js";const oe={class:"profile-public-grid"},ue={key:0,class:"panel profile-card"},re={key:1,class:"panel profile-card"},ie={class:"form-message form-message--error"},ce={key:2,class:"panel profile-card profile-public"},de={class:"panel-header profile-public-header"},ve={class:"panel-headline"},pe={class:"panel-sub"},fe={class:"public-avatar"},me={class:"public-stats"},ge={class:"stat-chip"},he={class:"stat-chip-value"},be={class:"stat-chip-value"},_e={class:"stat-chip"},ye={class:"stat-chip-value"},ke={class:"stat-chip"},Se={class:"stat-chip-value"},we={class:"public-badges"},Ce={key:0,class:"panel-sub"},Fe={key:1,class:"form-message form-message--error"},Be={key:2,class:"badge-grid"},Pe={class:"badge-icon"},Re={class:"badge-content"},Ie={class:"badge-label"},Ae={class:"badge-desc"},Ee={class:"badge-value"},je={key:3,class:"empty-state"},Le={key:0,class:"public-actions"},Me={key:2,class:"public-action-group"},qe=["disabled"],Ve=G({__name:"UserProfileView",setup(De){const I=H(),A=X(),s=i(null),k=i([]),S=i(!1),h=i(""),C=i(!1),p=i(""),u=i(""),r=i(!1),d=i(""),f=i(!1),B=c(()=>String(I.params.id??"")),b=c(()=>s.value?.friendStatus??"none"),E=c(()=>b.value==="self"),F=c(()=>b.value==="friends"),j=c(()=>b.value==="outgoing"),L=c(()=>b.value==="incoming"),P=c(()=>s.value?.isOnline),_=c(()=>typeof P.value=="boolean"),y=c(()=>P.value===!0),M=c(()=>{const e=s.value?.name?.trim()??"";return e&&e.split(" ").filter(Boolean).slice(0,2).map(t=>t[0]?.toUpperCase()??"").join("")||"?"}),q=e=>e==="streak"?"S":e==="tournament"?"T":e==="fairplay"?"F":"B",D=async e=>{S.value=!0,h.value="";try{k.value=await le(e)}catch(t){h.value=t.message,k.value=[]}finally{S.value=!1}},v=()=>{u.value="",r.value=!1,d.value="",f.value=!1},N=async()=>{v(),p.value="",s.value=null;const e=B.value;if(!e){p.value="Profil introuvable.";return}C.value=!0;try{const t=await te(e);t?(s.value=t,await D(e)):p.value="Profil introuvable."}catch(t){p.value=t.message}finally{C.value=!1}},O=async()=>{if(s.value){v();try{const e=await Z(s.value.id);u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},x=async()=>{if(s.value){v();try{const e=await R(s.value.id,"accept");u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},U=async()=>{if(s.value){v();try{const e=await R(s.value.id,"decline");u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},V=async()=>{if(s.value){v();try{const e=await ee(s.value.id);u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},z=async()=>{if(s.value){v();try{const e=await ae(s.value.id);u.value=e.message,r.value=!e.ok,e.ok&&(s.value.friendStatus=e.friendStatus)}catch(e){u.value=e.message,r.value=!0}}},$=async()=>{if(s.value){if(v(),!F.value){d.value="Ajoutez ce joueur en ami pour lancer un match.",f.value=!0;return}if(_.value&&!y.value){d.value="Ce joueur est hors ligne.",f.value=!0;return}try{const e=await se(s.value.id);d.value=e.message,f.value=!e.ok,e.ok&&e.status==="accepted"&&e.matchId&&(ne(),await A.push(`/jeu/${e.matchId}`))}catch(e){d.value=e.message,f.value=!0}}};return J(B,N,{immediate:!0}),(e,t)=>(l(),T(Y,{eyebrow:"Joueur",title:s.value?.name??"Profil joueur",subtitle:s.value?.title||"Profil public"},{default:K(()=>[a("section",oe,[C.value?(l(),n("div",ue,[...t[0]||(t[0]=[a("p",{class:"panel-title"},"Chargement",-1),a("p",{class:"panel-sub"},"Recuperation du profil en cours.",-1)])])):p.value?(l(),n("div",re,[a("p",ie,o(p.value),1)])):s.value?(l(),n("div",ce,[a("div",de,[a("div",null,[t[1]||(t[1]=a("p",{class:"panel-title"},"Profil public",-1)),a("h2",ve,o(s.value.name),1),a("p",pe,o(s.value.motto||"Aucune devise renseignee."),1)]),a("div",fe,o(M.value),1)]),a("div",me,[a("div",ge,[t[2]||(t[2]=a("span",{class:"stat-chip-label"},"Elo",-1)),a("span",he,o(s.value.rating),1)]),a("div",{class:w(["stat-chip",_.value?y.value?"stat-chip--online":"stat-chip--offline":"stat-chip--unknown"])},[t[3]||(t[3]=a("span",{class:"stat-chip-label"},"Statut",-1)),a("span",be,o(_.value?y.value?"En ligne":"Hors ligne":"Statut inconnu"),1)],2),a("div",_e,[t[4]||(t[4]=a("span",{class:"stat-chip-label"},"Localisation",-1)),a("span",ye,o(s.value.location||"Non renseignee"),1)]),a("div",ke,[t[5]||(t[5]=a("span",{class:"stat-chip-label"},"Derniere activite",-1)),a("span",Se,o(s.value.lastSeen||"Non renseignee"),1)])]),a("div",we,[t[6]||(t[6]=a("p",{class:"panel-title"},"Badges",-1)),t[7]||(t[7]=a("p",{class:"panel-sub"},"Series, tournois et fair-play.",-1)),S.value?(l(),n("p",Ce,"Chargement des badges...")):h.value?(l(),n("p",Fe,o(h.value),1)):(l(),n("div",Be,[(l(!0),n(Q,null,W(k.value,m=>(l(),n("article",{key:m.key,class:w(["badge-card",!m.earned&&"badge-card--locked"])},[a("div",Pe,o(q(m.key)),1),a("div",Re,[a("p",Ie,o(m.label),1),a("p",Ae,o(m.description),1),a("p",Ee,o(m.value),1)])],2))),128))])),!S.value&&!h.value&&!k.value.length?(l(),n("p",je," Aucun badge disponible. ")):g("",!0)]),E.value?g("",!0):(l(),n("div",Le,[b.value==="none"?(l(),n("button",{key:0,class:"button-primary",type:"button",onClick:O}," Demander en ami ")):j.value?(l(),n("button",{key:1,class:"button-ghost",type:"button",onClick:V}," Annuler la demande ")):L.value?(l(),n("div",Me,[a("button",{class:"button-primary",type:"button",onClick:x}," Accepter "),a("button",{class:"button-ghost",type:"button",onClick:U}," Refuser ")])):F.value?(l(),n("button",{key:3,class:"button-ghost",type:"button",onClick:z}," Retirer des amis ")):g("",!0),a("button",{class:"button-primary",type:"button",disabled:!F.value||_.value&&!y.value,onClick:$},o(_.value?y.value?"Lancer un match":"Indisponible":"Lancer un match"),9,qe)])),u.value?(l(),n("p",{key:1,class:w(["form-message",r.value?"form-message--error":"form-message--success"])},o(u.value),3)):g("",!0),d.value?(l(),n("p",{key:2,class:w(["form-message",f.value?"form-message--error":"form-message--success"])},o(d.value),3)):g("",!0)])):g("",!0)])]),_:1},8,["title","subtitle"]))}});export{Ve as default};
